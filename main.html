<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forest OS 98 - RudyWolf Edition</title>
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=L3mvqqgHeDB45alPStPdVBhF5-1jx99nxrZ03VIyIDrQBkQQPLuyLNzZEJ_ngFD1CGUeUG7w5WFa3MP60vTCyUOYhTUhG9RQVLnSIV2Onq0yDCwsV6sv3O0zX5bNURaFB9_O2xCUGC9A8F-42E3CncTCiqBLkr0Ct6fTW2SkUyvVnt9aQqgZuoA6V2sr-lZnRKNajlqNb7XINfwsGUljFflTR7c0au6-D6xUonyyLLe0YGxh-eH1Srz790tYluGZ-p1jtQwkoacV4Ejp3ypwfiWTI181JjSDJC7mJi1Cw5-GR0RZC5bdqEV7FbPgMEHFp4ZBkz0awYMkBlb785F8PLZgeQu5vpIOBgJnhhLfsU12h3laxUJFt-eg7xkPGE2UGPUYokculc-aDXyrqi2z4boQgXNyneh4PxUqEPjnojja8RYkUt2-98yv5FGPuoZInr0h0JaaKpybRB4Ysfxdr_tSvLL5wzZBVNirD0BpVgY6_m7NBCRZ9sZXpVq8zin8z5x4LfWsLpfdtzXwJlvFyCCDUB8AEXrSWAiWhIShSUxM9NuXv8VMzJ-2hE979VKdIKBFKdhweB6UQ13NqXbFVruj7fo6tE8nD3W1P6r-fHxxRA8dDfQM-5EkSE12TkYcj7A1dN_hqawJByaw3f4PzMCmp6YZttEwBWgsDuCvzOD1zK8HOZLUIiLDEGIJwRp_OwKMJLvrDG7h-rD680K_OQGkhrtnoi6opUSyl1a4kWM3Aq6v7climEWgkfKPHsTqO4s3XpOcSdVUTgbEh05iAPrntMhRP-tU0z8g5Opn4x5aWXKUmYqbuIp9-uF-YDhnntkbSgUxWIVeOz_KKyxosJVCG90HW2Dh4_9WZyY1pGYsF5J-Rcxr0gE8pBGD10FxxrtXfRy5ZsTQloWkP2Wn1DcmCguD5RwlH0m9ebQDC17buD-1Xp2zlb_B30lvHrEAWfjxhZmatIReFxvu_O9_Qny4LKuKAZoYvzO3X-pWlTfuiPA8KoVanIWqW7uYxO4XU1mCyn7OUDMOEQe6n2kys40NP1kPIcRS8NkY_b-Evs5KAOOvXFBgHVz_jHCaJFe7GZ6I6r1_ZEe6pOG634hqbocQpFFVHOuFw-BOYSjWRPw34oEhxIhMxsCUMca3ElplETmvYiLSLDS42pKGi1M1BjesD_vr42AguZiatKko9H3BTMYyjV0x2v5ZYSBj26vIjRpOzTzPx3az_D3omMCWjEdlunqDFEjEWJftQznIVgksX9J6zfBYrwj97Rx_fui4f-frhL1WUrguwLqK9eoIJYCDj_LXPyHc91aUwPNls1MT13g3OgJbyQszg-Q4tqp7Rbg1sStKj57fWDH4HCXjHAYla2YpfPpxgELYwMBoA2O5nq1AwGpEchgHkkgjkVHuJfZvpHXDNmYorWLAhCGZP3u-_kjiM0OUF0YFXVntU2h59FZptNwOfERkU4R4AoX26zTfhf86EPJ8rJ1TzJ4NHky8Zva-xT4P-h_nRDLjHVqUcU4tqzyBG9v1yeAIXk-LBKUyo6ZRP9gXIfRHvF_AGwemS0wwQbC9AKPaKV9HoxZU3x4v8QmUD6p30e-l8U8QS_5-sT0VSfEJlvA9ImVcH-Sx2wMMKx_J7tG_lcBeT01N71YtJK61hZn--N4Het31iLvBFdbsEb7fG8P5T-BpWU8tBETMkIf9HSq7pSXWxWF72I39ed7G_Y5OLVB1Aa7UqFfj9ZiDsdMyMmk7f90702-cz2GoLoicACUqCgYXpBVpQ5Vk7dxASOu-umByYrQHSRjanUWGRELmbf3urRbCQFwhdWE7RFw8-0wQccMEx5gv9R6ij4I9VqcywqdprSHoL2r6HJehwx8_XMoXeRLAkHd27ew9j6FF336Rx2F0fARVTN2D2KPBWu98psshb9-8O7NUS2WAHKpIHXLsBv4B15l8XHOJHKm2K1nP-xR9wsKuiCFRJnlzUzSikz7MPqDXapBLY2K8GNqOnHja3Aa6ti0bbnj_PnanfCwJdQ0UHJkMy_tuKfVldqUF6JB-kS6F5BhcYOPLe3V0qjVfyvgrswbbaCWhSTQVuuB9B-PZ9OzlYYgKM4qJ_ik8mYH4JOckJj0H0bWw6TqnSfMIuyV_gpEdy35wvK5OEGT4dMW-7vime032jPyYx0V2Nbl2JF5oU09DxuQ3BXlOwlbzECsXlN4ya6LDzoucsA5N5tMMx3JK59D47QdmZ3u2IJqrfFBhyPDJg1_vI3XcK_fpCpUiDdYoGsy8gnhpVDNJRbtBHXETtdhQSJ7tilY_urq4defB" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://gc.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9wcGwtYWktY29kZS1pbnRlcnByZXRlci1maWxlcy5zMy5hbWF6b25hd3MuY29tL3dlYi9kaXJlY3QtZmlsZXMvNjJkZmE5ZDJiOWVmMzI0ZjAyOTJjZjNlMjc3ZWVhMTUvNjJlOTI0NDItMTkzMi00Yjc4LWEyYTgtYjdlNjdkZWJlYTFkL2NhbnZhcy1hcHAvaW5kZXguaHRtbD9yZXNwb25zZS1jb250ZW50LWRpc3Bvc2l0aW9uPWF0dGFjaG1lbnQlM2IlMjBmaWxlbmFtZSUzZGluZGV4Lmh0bWwlM2IlMjBmaWxlbmFtZSUyYSUzZFVURi04JTI3JTI3aW5kZXguaHRtbCZBV1NBY2Nlc3NLZXlJZD1BU0lBMkYzRU1FWUVRVko1T0pLVCZTaWduYXR1cmU9cnlKYjhyRlhvWjI1NU5vOCUyZjE4Smo5SW94Sk0lM2QmeC1hbXotc2VjdXJpdHktdG9rZW49SVFvSmIzSnBaMmx1WDJWakVMdiUyZiUyZiUyZiUyZiUyZiUyZiUyZiUyZiUyZiUyZndFYUNYVnpMV1ZoYzNRdE1TSkhNRVVDSUdJJTJiR0hHbFElMmZzQ0UxR2ZuS2EwSGFqSGdnb0liZHN4QXNDbGIxMVNKR1JnQWlFQTJaWVhCYTlsbGNFZU0zS0NobFczV0hsb0VndUJpR051R1BJbzBnS3FDNkFxJTJmQVFJaFAlMmYlMmYlMmYlMmYlMmYlMmYlMmYlMmYlMmYlMmZBUkFCR2d3Mk9UazNOVE16TURrM01EVWlERXhyVHBjMUhnZGtMSGRDZ3lyUUJCMEh1YVdrczlNVWxoZ3FReHElMmZFMkp4QmtnV1JobFFPTjl2RE45d0tSeFNCcU5xS29ITiUyZkJYOEdMVjZEa0c5JTJmOWNVY2wyWm9SQkY4ZzRsTHRndnNCdDFqbUtJJTJiY24xRUdaUldKQ2drQ0VPcUN4dUkzU3V6VTFhTE9WZTZHOSUyZlZQQmRaZVFpcm1ES3R6bmVRUG9IS3klMmZkSFFQMDlkNHhhdSUyZkxPNWt3MTNydnozY3lkdk5RN2QzdjdrV0I5N09DbUg2c1puTVlMM0ZJYldyNVFTQ2hIR1l6bTNidHUwSnlYaCUyZmVKNks4dmdjSUVwU0Fia1N2M1VrRHREcHdlS2ZZZHcwODVYYzB5bFkzdUpBUXdLOXlucjFFUXZnSiUyZllrQ1BCNUlmcmtjejlEUmRXVFc1bEJkSVlYcW05bFVIUVM2UEJTN0ZUZE4xbDJxczRCaEpQZzdFWUMlMmJ3eDd1TDBaVDJiMjNzUCUyZldudnd1OGlreFVSNzI3MVpOT2xTaVVycXZIQzNROWxhOUJBZFFOeW5NM3RXeWtpUGxzNU5FN0FMMW9HTEk4NWhwamNhVEIlMmJ6WXF6SU8xOG9HVEZ6c0NaQ2hqMGNaajczaDd4SFcwcVR4aWdCcHl6ZkhKY3RvQ213JTJmWk52QU10azg1T1hSM3Z4Z2NPbEtuZkNEVzJHdlA5Y2NhUGJEdE1JSFh2SFE1bUNoWHlsQ1N3SllKVTJ0NGElMmJBdTN0YUNQNW5aTWdDc3RLNmhLeDFjZiUyYmdSMU1IVHZxVlFhcDllV2R1UEd6ck1vN1VOc0RVaXhYYjVmMFdPU2V3NE1VRGhjdUJsRGFhVWowTEhXcXJZRVhMa2xQOFJnbEZ5V0htaWhmQUVWY08wV2JiR1ZTMFB3a3BpNzBFYW0wRDRuRSUyZjl2RkF5dHZuNyUyYjZXd2ZJRDBpd2hPVFY4UDJrNUNzYyUyYjdXZGxYT1ZucXNDTmRyQk1FanQ1RkRmUlhyNGpNRUxid0lQcmpuTjNyOUpXcUlnNjduYVZacXptblRJaWJzMHh3ZFE1bjlkRldxeVluRXNGJTJiUVl3b2J5YnlRWTZtQUZnU3Q4bCUyYmhjTG1KY2tkall3UnlyNGxTaDQ2M1VLcURaZnlIU0dHc1ZRdSUyZlE3UzhBYmRyYnllYWZFJTJmdlJ2ekF5WlVNcDFKaXVYdEVVWFVFN2w0WDB4ak55NDZGNW9RSnR3MTRPQVc2NkI2WnglMmJ1ZGFJVENTb05uSXNoYWNaY05qRXRDUFYlMmIyeHdVZXlOQmY5NHFQcHF0clVTaGFma1RraGZuWjZWeVphYVdFdXB4MiUyYnFxaEJOeGRtcVFrMEJFVHloZ0dpM3NyUjU5USUzZCUzZCZFeHBpcmVzPTE3NjQxNTU5NjA"/><style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'MS Sans Serif', 'Microsoft Sans Serif', Arial, sans-serif;
            background: #008080;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            cursor: default;
            user-select: none;
            transition: background 0.5s ease;
        }

        body.bg-teal { background: #008080; }
        body.bg-green { background: #008000; }
        body.bg-blue { background: #000080; }
        body.bg-purple { background: #800080; }
        body.bg-black { background: #000000; }

        /* Login Screen */
        .login-screen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #0a4d3c 0%, #1a6b52 50%, #0a4d3c 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100000;
            transition: opacity 0.5s;
        }

        .login-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .login-logo {
            font-size: 48px;
            color: #00ff41;
            text-shadow: 0 0 20px #00ff41, 0 0 40px #00ff41;
            margin-bottom: 20px;
            font-weight: bold;
            letter-spacing: 4px;
        }

        .login-subtitle {
            color: rgba(0, 255, 65, 0.8);
            font-size: 14px;
            margin-bottom: 40px;
            text-align: center;
        }

        .login-box {
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            padding: 20px;
            min-width: 300px;
            box-shadow: 4px 4px 12px rgba(0,0,0,0.5);
        }

        .login-box h3 {
            margin-bottom: 16px;
            text-align: center;
            font-size: 14px;
        }

        .login-input {
            width: 100%;
            padding: 6px 8px;
            border: 2px inset #dfdfdf;
            font-size: 11px;
            margin-bottom: 16px;
        }

        .login-btn {
            width: 100%;
            padding: 6px;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            cursor: pointer;
            font-weight: bold;
            font-size: 11px;
        }

        .login-btn:active {
            border-style: inset;
        }

        /* Boot Screen */
        .boot-screen {
            position: fixed;
            inset: 0;
            background: black;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            padding: 20px;
            z-index: 99999;
            display: none;
            overflow-y: auto;
        }

        .boot-screen.active {
            display: block;
        }

        .boot-line {
            margin-bottom: 4px;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .boot-progress {
            margin-top: 20px;
            height: 20px;
            background: #333;
            border: 1px solid #00ff41;
            position: relative;
            overflow: hidden;
        }

        .boot-progress-bar {
            height: 100%;
            background: #00ff41;
            width: 0;
            transition: width 0.3s;
        }

        /* Desktop */
        .desktop {
            width: 100%;
            height: calc(100% - 28px);
            position: relative;
            overflow: hidden;
        }

        .desktop-icon {
            width: 75px;
            text-align: center;
            cursor: pointer;
            position: absolute;
            padding: 4px;
        }

        .desktop-icon:hover {
            background: rgba(10, 77, 60, 0.6);
            outline: 1px dotted rgba(0, 255, 65, 0.5);
        }

        .desktop-icon img {
            width: 32px;
            height: 32px;
            margin-bottom: 4px;
            filter: drop-shadow(0 0 4px rgba(0, 255, 65, 0.3));
        }

        .desktop-icon span {
            color: #e0ffe0;
            font-size: 11px;
            text-shadow: 1px 1px 3px #000, 0 0 8px rgba(0, 255, 65, 0.5);
            display: block;
            word-wrap: break-word;
        }

        /* Taskbar */
        .taskbar {
            height: 28px;
            background: linear-gradient(to bottom, #c3c3c3 0%, #808080 100%);
            border-top: 2px solid white;
            display: flex;
            align-items: center;
            padding: 0 2px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 10000;
        }

        .start-btn {
            height: 22px;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            padding: 0 5px 0 2px;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 11px;
        }

        .start-btn:active {
            border-style: inset;
        }

        .start-btn img {
            width: 16px;
            height: 16px;
        }

        .taskbar-items {
            flex: 1;
            margin-left: 4px;
            display: flex;
            gap: 2px;
            overflow-x: auto;
        }

        .taskbar-item {
            height: 22px;
            min-width: 120px;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            padding: 0 4px;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            font-size: 11px;
            overflow: hidden;
            white-space: nowrap;
        }

        .taskbar-item.active {
            border-style: inset;
        }

        .taskbar-item img {
            width: 16px;
            height: 16px;
        }

        .clock {
            height: 22px;
            background: #c0c0c0;
            border: 2px inset #dfdfdf;
            padding: 0 8px;
            display: flex;
            align-items: center;
            font-size: 11px;
            margin-left: 4px;
        }

        /* Start Menu */
        .start-menu {
            position: fixed;
            bottom: 28px;
            left: 0;
            width: 200px;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            display: none;
            flex-direction: column;
            z-index: 9999;
        }

        .start-menu.active {
            display: flex;
        }

        .start-menu-header {
            background: linear-gradient(to right, #0a4d3c, #1a6b52);
            color: #00ff41;
            padding: 4px 8px;
            font-weight: bold;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-shadow: 0 0 8px rgba(0, 255, 65, 0.8);
        }

        .start-menu-header::before {
            content: 'üê∫';
            font-size: 20px;
        }

        .start-menu-item {
            padding: 4px 24px 4px 32px;
            cursor: pointer;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            border-bottom: 1px solid #e0e0e0;
        }

        .start-menu-item:hover {
            background: linear-gradient(to right, #0a4d3c, #1a6b52);
            color: #00ff41;
        }

        .start-menu-item img {
            width: 16px;
            height: 16px;
            position: absolute;
            left: 8px;
        }

        .start-menu-separator {
            height: 2px;
            background: #808080;
            margin: 2px 0;
        }

        /* Window */
        .window {
            position: absolute;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            display: none;
            flex-direction: column;
            box-shadow: 2px 2px 8px rgba(0,0,0,0.3);
            min-width: 200px;
            min-height: 100px;
        }

        .window.active {
            display: flex;
            z-index: 1000;
        }

        .window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100% - 28px) !important;
        }

        .title-bar {
            background: linear-gradient(to right, #0a4d3c, #1a6b52);
            color: #00ff41;
            padding: 2px 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: move;
            font-weight: bold;
            font-size: 11px;
            text-shadow: 0 0 4px rgba(0, 255, 65, 0.6);
        }

        .title-bar-text {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .title-bar-text img {
            width: 16px;
            height: 16px;
        }

        .title-bar-controls {
            display: flex;
            gap: 2px;
        }

        .title-bar-btn {
            width: 16px;
            height: 14px;
            background: #c0c0c0;
            border: 1px outset #dfdfdf;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 9px;
            font-weight: bold;
        }

        .title-bar-btn:active {
            border-style: inset;
        }

        .window-content {
            flex: 1;
            overflow: auto;
            background: white;
            padding: 4px;
        }

        /* Wolf GPT Specific */
        .wolfgpt-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: #0f0f1e;
            padding: 0;
        }

        .wolfgpt-header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #00ff41;
            padding: 12px;
            text-align: center;
            border-bottom: 2px solid #0f3460;
        }

        .wolfgpt-header h2 {
            font-family: 'Courier New', monospace;
            font-size: 16px;
            text-shadow: 0 0 10px #00ff41;
            margin-bottom: 4px;
        }

        .wolfgpt-header p {
            font-size: 10px;
            opacity: 0.7;
        }

        .wolfgpt-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 8px;
        }

        .wolfgpt-btn {
            padding: 4px 12px;
            background: #16213e;
            color: #00ff41;
            border: 1px solid #0f3460;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            transition: all 0.2s;
        }

        .wolfgpt-btn:hover {
            background: #0f3460;
            box-shadow: 0 0 8px rgba(0, 255, 65, 0.3);
        }

        .wolfgpt-messages {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .wolfgpt-message {
            padding: 8px 12px;
            border-radius: 8px;
            max-width: 80%;
            word-wrap: break-word;
            font-size: 11px;
            font-family: 'Courier New', monospace;
        }

        .wolfgpt-message.user {
            background: #0f3460;
            color: #00ff41;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
        }

        .wolfgpt-message.assistant {
            background: rgba(0, 255, 65, 0.1);
            color: #00ff41;
            border: 1px solid #0f3460;
            align-self: flex-start;
            border-bottom-left-radius: 2px;
        }

        .wolfgpt-message.system {
            background: rgba(15, 52, 96, 0.3);
            color: rgba(0, 255, 65, 0.8);
            border: 1px solid #0f3460;
            align-self: center;
            text-align: center;
            font-size: 10px;
            font-style: italic;
        }

        .wolfgpt-typing {
            display: none;
            padding: 8px 12px;
            border-radius: 8px;
            background: rgba(0, 255, 65, 0.1);
            color: #00ff41;
            border: 1px solid #0f3460;
            align-self: flex-start;
            font-size: 11px;
        }

        .wolfgpt-typing.active {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .wolfgpt-typing span {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #00ff41;
            animation: typing 1.4s infinite;
        }

        .wolfgpt-typing span:nth-child(2) { animation-delay: 0.2s; }
        .wolfgpt-typing span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-8px); }
        }

        .wolfgpt-input-area {
            display: flex;
            gap: 4px;
            padding: 8px;
            background: #0f1824;
            border-top: 2px solid #0f3460;
        }

        .wolfgpt-input {
            flex: 1;
            padding: 6px 8px;
            background: #16213e;
            color: #00ff41;
            border: 1px solid #0f3460;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            resize: none;
        }

        .wolfgpt-input:focus {
            outline: none;
            box-shadow: 0 0 8px rgba(0, 255, 65, 0.3);
        }

        .wolfgpt-send {
            padding: 6px 12px;
            background: #16213e;
            color: #00ff41;
            border: 1px solid #00ff41;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            font-weight: bold;
        }

        .wolfgpt-send:hover:not(:disabled) {
            background: #00ff41;
            color: #0f0f1e;
        }

        .wolfgpt-send:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Paint Canvas */
        .paint-canvas {
            border: 1px solid black;
            cursor: crosshair;
            background: white;
        }

        .paint-tools {
            padding: 4px;
            border-bottom: 1px solid #808080;
            display: flex;
            gap: 4px;
        }

        .paint-tool {
            width: 32px;
            height: 32px;
            border: 2px outset #dfdfdf;
            background: #c0c0c0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .paint-tool.active {
            border-style: inset;
        }

        /* Solitaire */
        .solitaire-container {
            background: #008000;
            padding: 8px;
            height: 100%;
        }

        .card {
            width: 60px;
            height: 84px;
            background: white;
            border: 1px solid black;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
            user-select: none;
        }

        .card.back {
            background: #0000aa;
            background-image: repeating-linear-gradient(45deg, transparent, transparent 4px, rgba(255,255,255,.1) 4px, rgba(255,255,255,.1) 8px);
        }

        /* Minesweeper */
        .minesweeper-container {
            padding: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .mine-grid {
            display: grid;
            gap: 0;
            border: 3px inset #dfdfdf;
            background: #c0c0c0;
        }

        .mine-cell {
            width: 20px;
            height: 20px;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }

        .mine-cell.revealed {
            border: 1px solid #808080;
            background: #bfbfbf;
        }

        .mine-cell.flagged::after {
            content: 'üö©';
            font-size: 14px;
        }

        .mine-cell.mine::after {
            content: 'üí£';
            font-size: 14px;
        }

        /* Music Player */
        .player-btn {
            width: 40px;
            height: 40px;
            background: linear-gradient(to bottom, #c0c0c0, #808080);
            border: 2px outset #dfdfdf;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
        }

        .player-btn:hover {
            background: linear-gradient(to bottom, #d0d0d0, #909090);
        }

        .player-btn:active {
            border-style: inset;
            background: linear-gradient(to bottom, #808080, #c0c0c0);
        }

            -webkit-appearance: none;
            appearance: none;
            background: #808080;
            border: 2px inset #dfdfdf;
        }

            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
            cursor: pointer;
        }

        .playlist-item {
            padding: 4px 8px;
            cursor: pointer;
            border-bottom: 1px solid #1a1a1a;
        }

        .playlist-item:hover {
            background: rgba(0, 255, 65, 0.2);
        }

        .playlist-item.active {
            background: rgba(0, 255, 65, 0.3);
            font-weight: bold;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 16px;
            height: 16px;
        }

        ::-webkit-scrollbar-track {
            background: #c0c0c0;
        }

        ::-webkit-scrollbar-thumb {
            background: #808080;
            border: 2px outset #dfdfdf;
        }

        ::-webkit-scrollbar-button {
            background: #c0c0c0;
            border: 2px outset #dfdfdf;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-logo">üê∫ FOREST OS 98</div>
        <div class="login-subtitle">Wolf-Powered Operating System<br>by RudyWolf | rudywolf.ru</div>
        <div class="login-box">
            <h3>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
            <input type="text" class="login-input" id="usernameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–∏–∫–Ω–µ–π–º" maxlength="20">
            <button class="login-btn" onclick="login()">–í–û–ô–¢–ò</button>
        </div>
    </div>

    <!-- Boot Screen -->
    <div class="boot-screen" id="bootScreen">
        <div id="bootLog"></div>
        <div class="boot-progress">
            <div class="boot-progress-bar" id="bootProgress"></div>
        </div>
    </div>

    <!-- Desktop -->
    <div class="desktop" id="desktop">
        <div class="desktop-icon" style="left: 10px; top: 10px;" data-app="wolfgpt">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23000080' width='32' height='32'/%3E%3Ctext x='16' y='22' font-family='Arial' font-size='20' fill='%2300ff41' text-anchor='middle'%3EW%3C/text%3E%3C/svg%3E" alt="Wolf GPT">
            <span>Wolf GPT</span>
        </div>
        <div class="desktop-icon" style="left: 10px; top: 100px;" data-app="paint">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='white' width='32' height='32'/%3E%3Cpath fill='%23ff0000' d='M2 2 L30 30 M2 30 L30 2'/%3E%3C/svg%3E" alt="Paint">
            <span>Paint</span>
        </div>
        <div class="desktop-icon" style="left: 10px; top: 190px;" data-app="solitaire">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23008000' width='32' height='32'/%3E%3Crect fill='white' x='8' y='6' width='16' height='20' rx='2'/%3E%3Ctext x='16' y='20' font-size='16' text-anchor='middle'%3EA%3C/text%3E%3C/svg%3E" alt="Solitaire">
            <span>Solitaire</span>
        </div>
        <div class="desktop-icon" style="left: 10px; top: 280px;" data-app="minesweeper">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23c0c0c0' width='32' height='32'/%3E%3Ctext x='16' y='22' font-size='20' text-anchor='middle'%3Eüí£%3C/text%3E%3C/svg%3E" alt="Minesweeper">
            <span>Minesweeper</span>
        </div>
        <div class="desktop-icon" style="left: 10px; top: 370px;" data-app="browser">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%230000aa' width='32' height='32'/%3E%3Ctext x='16' y='22' font-size='18' fill='white' text-anchor='middle'%3EIE%3C/text%3E%3C/svg%3E" alt="Browser">
            <span>Forest Explorer</span>
        </div>
        <div class="desktop-icon" style="left: 95px; top: 10px;" data-app="mycomputer">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23808080' width='26' height='20' x='3' y='6'/%3E%3Crect fill='%23c0c0c0' width='14' height='4' x='9' y='26'/%3E%3C/svg%3E" alt="My Computer">
            <span>–ú–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä</span>
        </div>
        <div class="desktop-icon" style="left: 95px; top: 100px;" data-app="player">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23800080' width='32' height='32'/%3E%3Cpath fill='%2300ff41' d='M10 8 L22 16 L10 24 Z'/%3E%3C/svg%3E" alt="Music Player">
            <span>Forest Player</span>
        </div>
        <div class="desktop-icon" style="left: 95px; top: 190px;" data-app="terminal">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23000' width='32' height='32'/%3E%3Ctext x='4' y='20' font-family='monospace' font-size='16' fill='%2300ff41'%3E$_%3C/text%3E%3C/svg%3E" alt="Terminal">
            <span>WolfSH</span>
        </div>
        <div class="desktop-icon" style="left: 95px; top: 280px;" data-app="crypto">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23006400' width='32' height='32'/%3E%3Ctext x='16' y='22' font-family='monospace' font-size='18' fill='%23ffd700' text-anchor='middle'%3Eüîê%3C/text%3E%3C/svg%3E" alt="Crypto">
            <span>Crypto Tools</span>
        </div>
        <div class="desktop-icon" style="left: 95px; top: 370px;" data-app="nettools">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23000080' width='32' height='32'/%3E%3Ctext x='16' y='22' font-family='monospace' font-size='18' fill='%2300ffff' text-anchor='middle'%3Eüåê%3C/text%3E%3C/svg%3E" alt="Network">
            <span>Net Tools</span>
        </div>
        <div class="desktop-icon" style="left: 180px; top: 10px;" data-app="regex">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23800000' width='32' height='32'/%3E%3Ctext x='16' y='22' font-family='monospace' font-size='14' fill='%23ff6b6b' text-anchor='middle'%3E.*%3C/text%3E%3C/svg%3E" alt="Regex">
            <span>Regex Tester</span>
        </div>
        <div class="desktop-icon" style="left: 180px; top: 100px;" data-app="sysmon">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23404040' width='32' height='32'/%3E%3Ctext x='16' y='22' font-family='monospace' font-size='18' fill='%2300ff00' text-anchor='middle'%3Eüìä%3C/text%3E%3C/svg%3E" alt="Monitor">
            <span>System Mon</span>
        </div>
        <div class="desktop-icon" style="left: 180px; top: 190px;" data-app="files">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23ffcc00' width='32' height='32'/%3E%3Cpath fill='%23996600' d='M4 8 L14 8 L16 12 L28 12 L28 26 L4 26 Z'/%3E%3C/svg%3E" alt="Files">
            <span>File Manager</span>
        </div>
        <div class="desktop-icon" style="left: 180px; top: 280px;" data-app="editor">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23ffffff' width='32' height='32'/%3E%3Crect fill='%23007acc' width='28' height='28' x='2' y='2'/%3E%3Ctext x='16' y='22' font-family='monospace' font-size='16' fill='white' text-anchor='middle'%3E{;}%3C/text%3E%3C/svg%3E" alt="Editor">
            <span>Code Editor</span>
        </div>
        <div class="desktop-icon" style="left: 180px; top: 370px;" data-app="mesh">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%23004d00' width='32' height='32'/%3E%3Ccircle fill='%2300ff41' cx='16' cy='16' r='3'/%3E%3Ccircle fill='none' stroke='%2300ff41' stroke-width='2' cx='16' cy='16' r='8'/%3E%3Ccircle fill='none' stroke='%2300ff41' stroke-width='1' cx='16' cy='16' r='12'/%3E%3C/svg%3E" alt="Meshtastic">
            <span>Mesh Network</span>
        </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
        <div class="start-btn" id="startBtn">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23ff0000' width='16' height='16'/%3E%3Cpath fill='white' d='M3 3 L13 8 L3 13 Z'/%3E%3C/svg%3E" alt="Start">
            <span>–ü—É—Å–∫</span>
        </div>
        <div class="taskbar-items" id="taskbarItems"></div>
        <div class="clock" id="clock">00:00</div>
    </div>

    <!-- Start Menu -->
    <div class="start-menu" id="startMenu">
        <div class="start-menu-header">Forest OS 98</div>
        <div class="start-menu-item" data-app="wolfgpt">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23000080' width='16' height='16'/%3E%3Ctext x='8' y='12' font-size='10' fill='%2300ff41' text-anchor='middle'%3EW%3C/text%3E%3C/svg%3E" alt="">
            Wolf GPT
        </div>
        <div class="start-menu-item" data-app="browser">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%230000aa' width='16' height='16'/%3E%3C/svg%3E" alt="">
            Forest Explorer
        </div>
        <div class="start-menu-separator"></div>
        <div class="start-menu-item" data-app="paint">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='white' width='16' height='16'/%3E%3Cpath fill='%23ff0000' d='M2 2 L14 14 M2 14 L14 2'/%3E%3C/svg%3E" alt="">
            Paint
        </div>
        <div class="start-menu-item" data-app="solitaire">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23008000' width='16' height='16'/%3E%3Crect fill='white' x='4' y='2' width='8' height='12' rx='1'/%3E%3C/svg%3E" alt="">
            Solitaire
        </div>
        <div class="start-menu-item" data-app="minesweeper">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23c0c0c0' width='16' height='16'/%3E%3Ctext x='8' y='12' font-size='12' text-anchor='middle'%3Eüí£%3C/text%3E%3C/svg%3E" alt="">
            Minesweeper
        </div>
        <div class="start-menu-separator"></div>
        <div class="start-menu-item" data-app="mycomputer">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23808080' width='16' height='16'/%3E%3C/svg%3E" alt="">
            –ú–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä
        </div>
        <div class="start-menu-separator"></div>
        <div class="start-menu-item" data-app="player">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23800080' width='16' height='16'/%3E%3Cpath fill='%2300ff41' d='M5 4 L11 8 L5 12 Z'/%3E%3C/svg%3E" alt="">
            Forest Player
        </div>
        <div class="start-menu-separator"></div>
        <div class="start-menu-item" data-app="terminal">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23000' width='16' height='16'/%3E%3C/svg%3E" alt="">
            WolfSH Terminal
        </div>
        <div class="start-menu-item" data-app="crypto">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23006400' width='16' height='16'/%3E%3C/svg%3E" alt="">
            Crypto Toolkit
        </div>
        <div class="start-menu-item" data-app="nettools">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23000080' width='16' height='16'/%3E%3C/svg%3E" alt="">
            Network Tools
        </div>
        <div class="start-menu-item" data-app="regex">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23800000' width='16' height='16'/%3E%3C/svg%3E" alt="">
            Regex Tester
        </div>
        <div class="start-menu-item" data-app="sysmon">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23404040' width='16' height='16'/%3E%3C/svg%3E" alt="">
            System Monitor
        </div>
        <div class="start-menu-item" data-app="files">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23ffcc00' width='16' height='16'/%3E%3C/svg%3E" alt="">
            File Manager
        </div>
        <div class="start-menu-item" data-app="editor">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23007acc' width='16' height='16'/%3E%3C/svg%3E" alt="">
            Code Editor
        </div>
        <div class="start-menu-separator"></div>
        <div class="start-menu-item" data-app="mesh">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23004d00' width='16' height='16'/%3E%3Ccircle fill='%2300ff41' cx='8' cy='8' r='2'/%3E%3C/svg%3E" alt="">
            Mesh Network
        </div>
        <div class="start-menu-separator"></div>
        <div class="start-menu-item" onclick="showAbout()">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Ccircle fill='%230000aa' cx='8' cy='8' r='7'/%3E%3Ctext x='8' y='12' font-size='10' fill='white' text-anchor='middle'%3E?%3C/text%3E%3C/svg%3E" alt="">
            –û —Å–∏—Å—Ç–µ–º–µ
        </div>
    </div>

    <!-- Wolf GPT Window -->
    <div class="window" id="wolfgptWindow" style="left: 100px; top: 50px; width: 600px; height: 500px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23000080' width='16' height='16'/%3E%3Ctext x='8' y='12' font-size='10' fill='%2300ff41' text-anchor='middle'%3EW%3C/text%3E%3C/svg%3E" alt="">
                Wolf GPT
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('wolfgptWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('wolfgptWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('wolfgptWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div class="wolfgpt-container">
                <div class="wolfgpt-header">
                    <h2>WOLF GPT TERMINAL</h2>
                    <p>Cyber Wolf AI by RudyWolf | rudywolf.ru</p>
                    <div class="wolfgpt-controls">
                        <button class="wolfgpt-btn" onclick="exportChatHistory()">üì• –≠–∫—Å–ø–æ—Ä—Ç</button>
                        <button class="wolfgpt-btn" onclick="clearChatHistory()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button class="wolfgpt-btn" onclick="showChatHistory()">üìú –ò—Å—Ç–æ—Ä–∏—è</button>
                    </div>
                </div>
                <div class="wolfgpt-messages" id="wolfgptMessages"></div>
                <div class="wolfgpt-typing" id="wolfgptTyping">
                    <span></span><span></span><span></span>
                </div>
                <div class="wolfgpt-input-area">
                    <textarea class="wolfgpt-input" id="wolfgptInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." rows="1"></textarea>
                    <button class="wolfgpt-send" id="wolfgptSend">SEND</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Paint Window -->
    <div class="window" id="paintWindow" style="left: 150px; top: 100px; width: 500px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='white' width='16' height='16'/%3E%3Cpath fill='%23ff0000' d='M2 2 L14 14 M2 14 L14 2'/%3E%3C/svg%3E" alt="">
                Paint
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('paintWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('paintWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('paintWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0;">
            <div class="paint-tools">
                <div class="paint-tool active" data-tool="pencil">‚úèÔ∏è</div>
                <div class="paint-tool" data-tool="eraser">üßπ</div>
                <div class="paint-tool" data-tool="clear">üóëÔ∏è</div>
            </div>
            <canvas class="paint-canvas" id="paintCanvas" width="480" height="320"></canvas>
        </div>
    </div>

    <!-- Solitaire Window -->
    <div class="window" id="solitaireWindow" style="left: 200px; top: 150px; width: 600px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23008000' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Solitaire
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('solitaireWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('solitaireWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('solitaireWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div class="solitaire-container">
                <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                    <div class="card back" onclick="dealCard()">üÇ†</div>
                    <div class="card" id="currentCard" style="visibility: hidden;">A‚ô†</div>
                </div>
                <div style="display: flex; gap: 8px;">
                    <div class="card" style="background: rgba(255,255,255,0.2); border-style: dashed;">‚ô†</div>
                    <div class="card" style="background: rgba(255,255,255,0.2); border-style: dashed;">‚ô•</div>
                    <div class="card" style="background: rgba(255,255,255,0.2); border-style: dashed;">‚ô£</div>
                    <div class="card" style="background: rgba(255,255,255,0.2); border-style: dashed;">‚ô¶</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Minesweeper Window -->
    <div class="window" id="minesweeperWindow" style="left: 250px; top: 200px; width: 300px; height: 350px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23c0c0c0' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Minesweeper
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('minesweeperWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('minesweeperWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('minesweeperWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div class="minesweeper-container">
                <button style="margin-bottom: 8px;" onclick="initMinesweeper()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                <div class="mine-grid" id="mineGrid"></div>
            </div>
        </div>
    </div>

    <!-- Browser Window -->
    <div class="window" id="browserWindow" style="left: 300px; top: 100px; width: 700px; height: 500px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%230000aa' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Forest Explorer
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('browserWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('browserWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('browserWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0;">
            <div style="padding: 4px; border-bottom: 2px groove #dfdfdf; display: flex; gap: 4px; align-items: center;">
                <button style="padding: 2px 8px; border: 2px outset #dfdfdf; background: #c0c0c0;" onclick="browserGo()">‚Üí</button>
                <input id="browserUrl" type="text" value="rudywolf.ru" style="flex: 1; padding: 2px 4px; border: 2px inset #dfdfdf;" onkeypress="if(event.key==='Enter')browserGo()">
            </div>
            <iframe id="browserFrame" style="width: 100%; height: calc(100% - 32px); border: none; background: white;"></iframe>
        </div>
    </div>

    <!-- Music Player Window -->
    <div class="window" id="playerWindow" style="left: 400px; top: 200px; width: 400px; height: 450px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23800080' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Forest Player
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('playerWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('playerWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('playerWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0; background: black;">
            <div style="padding: 12px; background: linear-gradient(to bottom, #2a2a2a, #1a1a1a); border-bottom: 2px solid #00ff41;">
                <canvas id="visualizer" width="376" height="150" style="width: 100%; height: 150px; background: black; border: 2px inset #808080;"></canvas>
            </div>
            <div style="padding: 12px; background: #1a1a1a;">
                <div style="color: #00ff41; font-family: 'Courier New', monospace; font-size: 14px; margin-bottom: 8px; text-align: center; text-shadow: 0 0 8px #00ff41;">
                    <div id="trackName">‚ô´ –ù–∞–∂–º–∏—Ç–µ Play ‚ô´</div>
                </div>
                <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                    <input type="range" id="progressBar" min="0" max="100" value="0" style="flex: 1; height: 20px;">
                    <span id="timeDisplay" style="color: #00ff41; font-family: 'Courier New', monospace; font-size: 11px; min-width: 80px;">0:00 / 0:00</span>
                </div>
                <div style="display: flex; justify-content: center; gap: 8px; margin-bottom: 12px;">
                    <button class="player-btn" onclick="prevTrack()">‚èÆ</button>
                    <button class="player-btn" id="playPauseBtn" onclick="togglePlay()">‚ñ∂</button>
                    <button class="player-btn" onclick="stopMusic()">‚èπ</button>
                    <button class="player-btn" onclick="nextTrack()">‚è≠</button>
                </div>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <span style="color: #00ff41; font-size: 11px;">üîä</span>
                    <input type="range" id="volumeControl" min="0" max="100" value="70" style="flex: 1; height: 16px;">
                    <span id="volumeDisplay" style="color: #00ff41; font-family: 'Courier New', monospace; font-size: 11px; min-width: 35px;">70%</span>
                </div>
                <div style="margin-top: 12px; max-height: 120px; overflow-y: auto; border: 2px inset #808080; background: #0a0a0a; padding: 4px;">
                    <div id="playlist" style="color: #00ff41; font-family: 'Courier New', monospace; font-size: 10px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Terminal Window -->
    <div class="window" id="terminalWindow" style="left: 50px; top: 50px; width: 700px; height: 450px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23000' width='16' height='16'/%3E%3C/svg%3E" alt="">
                WolfSH Terminal
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('terminalWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('terminalWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('terminalWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0; background: #000; color: #00ff41; font-family: 'Courier New', monospace; font-size: 12px;">
            <div id="terminalOutput" style="padding: 8px; height: calc(100% - 30px); overflow-y: auto;"></div>
            <div style="display: flex; padding: 4px; background: #0a0a0a;">
                <span style="color: #00ff41; padding: 0 4px;">wolfsh$</span>
                <input type="text" id="terminalInput" style="flex: 1; background: transparent; border: none; color: #00ff41; font-family: 'Courier New', monospace; outline: none; font-size: 12px;">
            </div>
        </div>
    </div>

    <!-- Crypto Toolkit Window -->
    <div class="window" id="cryptoWindow" style="left: 100px; top: 100px; width: 600px; height: 500px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23006400' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Crypto Toolkit
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('cryptoWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('cryptoWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('cryptoWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div style="padding: 8px;">
                <div style="margin-bottom: 12px; display: flex; gap: 4px;">
                    <button onclick="switchCryptoTab('encode')" id="cryptoTabEncode" class="crypto-tab active">Encode</button>
                    <button onclick="switchCryptoTab('decode')" id="cryptoTabDecode" class="crypto-tab">Decode</button>
                    <button onclick="switchCryptoTab('hash')" id="cryptoTabHash" class="crypto-tab">Hash</button>
                    <button onclick="switchCryptoTab('password')" id="cryptoTabPassword" class="crypto-tab">Password Gen</button>
                </div>
                
                <div id="cryptoTabContentEncode" class="crypto-tab-content" style="display: block;">
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Algorithm:</label>
                    <select id="encodeAlgo" style="width: 100%; margin-bottom: 8px; padding: 4px;">
                        <option value="base64">Base64</option>
                        <option value="rot13">ROT13</option>
                        <option value="caesar">Caesar Cipher (shift 3)</option>
                        <option value="reverse">Reverse</option>
                    </select>
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Input:</label>
                    <textarea id="encodeInput" style="width: 100%; height: 100px; padding: 4px; font-family: monospace; font-size: 11px; margin-bottom: 8px;"></textarea>
                    <button onclick="encodeText()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üîí Encode</button>
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Output:</label>
                    <textarea id="encodeOutput" readonly style="width: 100%; height: 100px; padding: 4px; font-family: monospace; font-size: 11px; background: #f0f0f0;"></textarea>
                </div>
                
                <div id="cryptoTabContentDecode" class="crypto-tab-content">
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Algorithm:</label>
                    <select id="decodeAlgo" style="width: 100%; margin-bottom: 8px; padding: 4px;">
                        <option value="base64">Base64</option>
                        <option value="rot13">ROT13</option>
                        <option value="caesar">Caesar Cipher (shift 3)</option>
                        <option value="reverse">Reverse</option>
                    </select>
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Input:</label>
                    <textarea id="decodeInput" style="width: 100%; height: 100px; padding: 4px; font-family: monospace; font-size: 11px; margin-bottom: 8px;"></textarea>
                    <button onclick="decodeText()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üîì Decode</button>
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Output:</label>
                    <textarea id="decodeOutput" readonly style="width: 100%; height: 100px; padding: 4px; font-family: monospace; font-size: 11px; background: #f0f0f0;"></textarea>
                </div>
                
                <div id="cryptoTabContentHash" class="crypto-tab-content">
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Input:</label>
                    <textarea id="hashInput" style="width: 100%; height: 100px; padding: 4px; font-family: monospace; font-size: 11px; margin-bottom: 8px;"></textarea>
                    <button onclick="computeHashes()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üîç Compute Hashes</button>
                    <div style="font-family: monospace; font-size: 10px; background: #f0f0f0; padding: 8px; border: 1px solid #ccc; max-height: 200px; overflow-y: auto;">
                        <div id="hashOutput">Hashes will appear here...</div>
                    </div>
                </div>
                
                <div id="cryptoTabContentPassword" class="crypto-tab-content">
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Length:</label>
                    <input type="number" id="passwordLength" value="16" min="8" max="64" style="width: 100%; padding: 4px; margin-bottom: 8px;">
                    <div style="margin-bottom: 8px;">
                        <label style="font-size: 11px;"><input type="checkbox" id="passLower" checked> Lowercase</label><br>
                        <label style="font-size: 11px;"><input type="checkbox" id="passUpper" checked> Uppercase</label><br>
                        <label style="font-size: 11px;"><input type="checkbox" id="passNumbers" checked> Numbers</label><br>
                        <label style="font-size: 11px;"><input type="checkbox" id="passSymbols" checked> Symbols (!@#$%^&*)</label>
                    </div>
                    <button onclick="generatePassword()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üé≤ Generate Password</button>
                    <textarea id="passwordOutput" readonly style="width: 100%; height: 60px; padding: 4px; font-family: monospace; font-size: 14px; background: #f0f0f0; font-weight: bold;"></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Network Tools Window -->
    <div class="window" id="nettoolsWindow" style="left: 150px; top: 80px; width: 650px; height: 500px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23000080' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Network Tools
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('nettoolsWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('nettoolsWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('nettoolsWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div style="padding: 8px;">
                <div style="margin-bottom: 12px; display: flex; gap: 4px;">
                    <button onclick="switchNetTab('portscan')" id="netTabPortscan" class="crypto-tab active">Port Scanner</button>
                    <button onclick="switchNetTab('ping')" id="netTabPing" class="crypto-tab">Ping</button>
                    <button onclick="switchNetTab('whois')" id="netTabWhois" class="crypto-tab">WHOIS</button>
                </div>
                
                <div id="netTabContentPortscan" class="crypto-tab-content" style="display: block;">
                    <p style="font-size: 10px; color: #666; margin-bottom: 8px;">‚ö†Ô∏è Educational simulation only. No real network scanning.</p>
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Target (e.g., 192.168.1.1):</label>
                    <input type="text" id="scanTarget" value="192.168.1.1" style="width: 100%; padding: 4px; margin-bottom: 8px;">
                    <button onclick="simulatePortScan()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üîç Scan Ports</button>
                    <div style="font-family: monospace; font-size: 10px; background: #000; color: #0f0; padding: 8px; height: 300px; overflow-y: auto; border: 2px inset #808080;">
                        <div id="portscanOutput">Ready to scan...</div>
                    </div>
                </div>
                
                <div id="netTabContentPing" class="crypto-tab-content">
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Host:</label>
                    <input type="text" id="pingHost" value="google.com" style="width: 100%; padding: 4px; margin-bottom: 8px;">
                    <button onclick="simulatePing()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üì° Ping</button>
                    <div style="font-family: monospace; font-size: 10px; background: #000; color: #0f0; padding: 8px; height: 320px; overflow-y: auto; border: 2px inset #808080;">
                        <div id="pingOutput">Ready to ping...</div>
                    </div>
                </div>
                
                <div id="netTabContentWhois" class="crypto-tab-content">
                    <label style="font-size: 11px; display: block; margin-bottom: 4px;">Domain:</label>
                    <input type="text" id="whoisDomain" value="rudywolf.ru" style="width: 100%; padding: 4px; margin-bottom: 8px;">
                    <button onclick="simulateWhois()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üåê WHOIS Lookup</button>
                    <div style="font-family: monospace; font-size: 10px; background: #000; color: #0f0; padding: 8px; height: 320px; overflow-y: auto; border: 2px inset #808080;">
                        <div id="whoisOutput">Ready to lookup...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Regex Tester Window -->
    <div class="window" id="regexWindow" style="left: 200px; top: 120px; width: 600px; height: 450px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23800000' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Regex Tester
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('regexWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('regexWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('regexWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div style="padding: 8px;">
                <label style="font-size: 11px; display: block; margin-bottom: 4px;">Pattern:</label>
                <input type="text" id="regexPattern" value="\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b" style="width: 100%; padding: 4px; margin-bottom: 8px; font-family: monospace;">
                <div style="margin-bottom: 8px;">
                    <label style="font-size: 11px;"><input type="checkbox" id="regexGlobal" checked> Global (g)</label>
                    <label style="font-size: 11px; margin-left: 12px;"><input type="checkbox" id="regexCase"> Case Insensitive (i)</label>
                    <label style="font-size: 11px; margin-left: 12px;"><input type="checkbox" id="regexMulti"> Multiline (m)</label>
                </div>
                <label style="font-size: 11px; display: block; margin-bottom: 4px;">Test String:</label>
                <textarea id="regexTestString" style="width: 100%; height: 120px; padding: 4px; font-family: monospace; font-size: 11px; margin-bottom: 8px;">Contact me at wolf@rudywolf.ru or admin@example.com
Visit rudywolf.ru for more info!</textarea>
                <button onclick="testRegex()" style="width: 100%; padding: 6px; margin-bottom: 8px;">üéØ Test Pattern</button>
                <div style="border: 2px inset #808080; padding: 8px; background: #fff; min-height: 100px; max-height: 120px; overflow-y: auto;">
                    <div id="regexResults" style="font-family: monospace; font-size: 11px;">Results will appear here...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Monitor Window -->
    <div class="window" id="sysmonWindow" style="left: 250px; top: 150px; width: 550px; height: 420px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23404040' width='16' height='16'/%3E%3C/svg%3E" alt="">
                System Monitor
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('sysmonWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('sysmonWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('sysmonWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div style="padding: 12px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 12px;">CPU Usage</h4>
                        <canvas id="cpuChart" width="240" height="80" style="border: 2px inset #808080; background: #000;"></canvas>
                        <div id="cpuValue" style="margin-top: 4px; font-size: 11px; font-weight: bold; color: #00ff41;">0%</div>
                    </div>
                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 12px;">Memory Usage</h4>
                        <canvas id="memChart" width="240" height="80" style="border: 2px inset #808080; background: #000;"></canvas>
                        <div id="memValue" style="margin-top: 4px; font-size: 11px; font-weight: bold; color: #00ff41;">0%</div>
                    </div>
                </div>
                <h4 style="margin: 12px 0 8px 0; font-size: 12px;">Processes</h4>
                <div style="border: 2px inset #808080; background: #fff; height: 180px; overflow-y: auto; font-family: monospace; font-size: 10px;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead style="background: #c0c0c0; position: sticky; top: 0;">
                            <tr>
                                <th style="padding: 4px; text-align: left; border-bottom: 1px solid #808080;">PID</th>
                                <th style="padding: 4px; text-align: left; border-bottom: 1px solid #808080;">Name</th>
                                <th style="padding: 4px; text-align: right; border-bottom: 1px solid #808080;">CPU%</th>
                                <th style="padding: 4px; text-align: right; border-bottom: 1px solid #808080;">MEM%</th>
                            </tr>
                        </thead>
                        <tbody id="processTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- File Manager Window -->
    <div class="window" id="filesWindow" style="left: 300px; top: 180px; width: 600px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23ffcc00' width='16' height='16'/%3E%3C/svg%3E" alt="">
                File Manager
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('filesWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('filesWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('filesWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0;">
            <div style="padding: 4px; border-bottom: 2px groove #dfdfdf; display: flex; gap: 4px; align-items: center; background: #c0c0c0;">
                <button style="padding: 2px 8px;" onclick="fileManagerUp()">‚¨ÜÔ∏è Up</button>
                <button style="padding: 2px 8px;" onclick="fileManagerRefresh()">üîÑ</button>
                <input type="text" id="fileManagerPath" value="/home/wolf" readonly style="flex: 1; padding: 2px 4px; border: 2px inset #dfdfdf; background: #fff;">
            </div>
            <div id="fileManagerContent" style="padding: 8px; height: calc(100% - 40px); overflow-y: auto; background: #fff; font-family: monospace; font-size: 11px;"></div>
        </div>
    </div>

    <!-- Meshtastic Window -->
    <div class="window" id="meshWindow" style="left: 120px; top: 80px; width: 750px; height: 550px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23004d00' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Mesh Network - Meshtastic
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('meshWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('meshWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('meshWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0; background: #0a0a0a;">
            <div style="display: flex; height: 100%;">
                <!-- Sidebar -->
                <div style="width: 180px; background: #1a1a1a; border-right: 2px solid #00ff41; display: flex; flex-direction: column;">
                    <div style="padding: 12px; border-bottom: 2px solid #00ff41;">
                        <div style="color: #00ff41; font-weight: bold; font-size: 12px; margin-bottom: 8px;">üåê Mesh Status</div>
                        <div style="font-size: 10px; color: #00ff41; font-family: monospace;">
                            <div id="meshStatus">‚óè Offline</div>
                            <div id="meshNodes" style="margin-top: 4px;">Nodes: 0</div>
                        </div>
                    </div>
                    <div style="padding: 8px; flex: 1; overflow-y: auto;">
                        <button onclick="switchMeshTab('chat')" id="meshTabChat" class="mesh-tab active" style="width: 100%; margin-bottom: 4px;">üí¨ Chat</button>
                        <button onclick="switchMeshTab('nodes')" id="meshTabNodes" class="mesh-tab" style="width: 100%; margin-bottom: 4px;">üì° Nodes</button>
                        <button onclick="switchMeshTab('map')" id="meshTabMap" class="mesh-tab" style="width: 100%; margin-bottom: 4px;">üó∫Ô∏è Map</button>
                        <button onclick="switchMeshTab('rudywolf')" id="meshTabRudywolf" class="mesh-tab" style="width: 100%; margin-bottom: 4px;">üê∫ RudyWolf</button>
                    </div>
                    <div style="padding: 8px; border-top: 2px solid #00ff41;">
                        <button onclick="meshConnect()" id="meshConnectBtn" style="width: 100%; padding: 6px; background: #004d00; color: #00ff41; border: 1px solid #00ff41; cursor: pointer; font-size: 10px; font-weight: bold;">üîå Connect</button>
                    </div>
                </div>
                
                <!-- Main Content -->
                <div style="flex: 1; display: flex; flex-direction: column;">
                    <!-- Chat Tab -->
                    <div id="meshContentChat" class="mesh-content" style="display: flex; flex-direction: column; height: 100%;">
                        <div style="padding: 8px; background: #1a1a1a; border-bottom: 2px solid #00ff41;">
                            <h3 style="color: #00ff41; margin: 0; font-size: 14px;">üí¨ Mesh Chat</h3>
                            <p style="color: #00ff41; opacity: 0.7; margin: 4px 0 0 0; font-size: 10px;">Global mesh network messages</p>
                        </div>
                        <div id="meshChatMessages" style="flex: 1; overflow-y: auto; padding: 12px; font-family: 'Courier New', monospace; font-size: 11px; color: #00ff41;"></div>
                        <div style="padding: 8px; background: #1a1a1a; border-top: 2px solid #00ff41; display: flex; gap: 4px;">
                            <input type="text" id="meshChatInput" placeholder="Type message..." style="flex: 1; padding: 6px; background: #0a0a0a; border: 1px solid #00ff41; color: #00ff41; font-family: monospace; font-size: 11px;">
                            <button onclick="meshSendMessage()" style="padding: 6px 12px; background: #004d00; color: #00ff41; border: 1px solid #00ff41; cursor: pointer; font-weight: bold;">SEND</button>
                        </div>
                    </div>
                    
                    <!-- Nodes Tab -->
                    <div id="meshContentNodes" class="mesh-content" style="display: none; flex-direction: column; height: 100%;">
                        <div style="padding: 8px; background: #1a1a1a; border-bottom: 2px solid #00ff41;">
                            <h3 style="color: #00ff41; margin: 0; font-size: 14px;">üì° Active Nodes</h3>
                            <p style="color: #00ff41; opacity: 0.7; margin: 4px 0 0 0; font-size: 10px;">Mesh network topology</p>
                        </div>
                        <div style="flex: 1; overflow-y: auto; padding: 12px;">
                            <div id="meshNodesList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px;"></div>
                        </div>
                    </div>
                    
                    <!-- Map Tab -->
                    <div id="meshContentMap" class="mesh-content" style="display: none; flex-direction: column; height: 100%;">
                        <div style="padding: 8px; background: #1a1a1a; border-bottom: 2px solid #00ff41;">
                            <h3 style="color: #00ff41; margin: 0; font-size: 14px;">üó∫Ô∏è Node Map</h3>
                            <p style="color: #00ff41; opacity: 0.7; margin: 4px 0 0 0; font-size: 10px;">Geographic distribution of mesh nodes</p>
                        </div>
                        <div style="flex: 1; position: relative; background: #000;">
                            <canvas id="meshMapCanvas" style="width: 100%; height: 100%;"></canvas>
                        </div>
                    </div>
                    
                    <!-- RudyWolf Node Tab -->
                    <div id="meshContentRudywolf" class="mesh-content" style="display: none; flex-direction: column; height: 100%;">
                        <div style="padding: 8px; background: #1a1a1a; border-bottom: 2px solid #00ff41;">
                            <h3 style="color: #00ff41; margin: 0; font-size: 14px;">üê∫ RudyWolf Node</h3>
                            <p style="color: #00ff41; opacity: 0.7; margin: 4px 0 0 0; font-size: 10px;">Messages from rudywolf mesh node</p>
                        </div>
                        <div id="meshRudywolfMessages" style="flex: 1; overflow-y: auto; padding: 12px; font-family: 'Courier New', monospace; font-size: 11px; color: #00ff41;"></div>
                        <div style="padding: 12px; background: #1a1a1a; border-top: 2px solid #00ff41;">
                            <div style="color: #00ff41; font-size: 10px; font-family: monospace;">
                                <div><strong>Node ID:</strong> !rudywolf</div>
                                <div><strong>Long Name:</strong> RudyWolf Forest Node</div>
                                <div><strong>Status:</strong> <span id="rudywolfNodeStatus">Offline</span></div>
                                <div><strong>Last Seen:</strong> <span id="rudywolfLastSeen">Never</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Code Editor Window -->
    <div class="window" id="editorWindow" style="left: 350px; top: 200px; width: 700px; height: 500px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23007acc' width='16' height='16'/%3E%3C/svg%3E" alt="">
                Code Editor - <span id="editorFileName">untitled.txt</span>
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('editorWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('editorWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('editorWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0;">
            <div style="padding: 4px; border-bottom: 2px groove #dfdfdf; display: flex; gap: 4px; background: #c0c0c0;">
                <button style="padding: 2px 8px;" onclick="editorNew()">üìÑ New</button>
                <button style="padding: 2px 8px;" onclick="editorSave()">üíæ Save</button>
                <select id="editorLang" onchange="editorSetLanguage()" style="padding: 2px;">
                    <option value="text">Plain Text</option>
                    <option value="javascript">JavaScript</option>
                    <option value="html">HTML</option>
                    <option value="css">CSS</option>
                    <option value="python">Python</option>
                </select>
            </div>
            <textarea id="editorContent" style="width: 100%; height: calc(100% - 40px); padding: 8px; font-family: 'Courier New', monospace; font-size: 12px; border: none; resize: none; line-height: 1.5;">// Welcome to Forest Code Editor
// Start coding...
</textarea>
        </div>
    </div>

    <!-- My Computer Window -->
    <div class="window" id="mycomputerWindow" style="left: 350px; top: 150px; width: 500px; height: 400px;">
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Crect fill='%23808080' width='16' height='16'/%3E%3C/svg%3E" alt="">
                –ú–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä
            </div>
            <div class="title-bar-controls">
                <div class="title-bar-btn" onclick="minimizeWindow('mycomputerWindow')">_</div>
                <div class="title-bar-btn" onclick="maximizeWindow('mycomputerWindow')">‚ñ°</div>
                <div class="title-bar-btn" onclick="closeWindow('mycomputerWindow')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div style="padding: 16px;">
                <h3 style="margin-bottom: 16px;">üê∫ Forest OS 98</h3>
                <p style="margin-bottom: 8px;"><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> <span id="currentUsername"></span></p>
                <p style="margin-bottom: 8px;"><strong>–í–µ—Ä—Å–∏—è:</strong> Forest OS 98 Wolf Edition v1.0</p>
                <p style="margin-bottom: 8px;"><strong>–í–ª–∞–¥–µ–ª–µ—Ü:</strong> RudyWolf</p>
                <p style="margin-bottom: 8px;"><strong>–°–∞–π—Ç:</strong> rudywolf.ru</p>
                <hr style="margin: 16px 0;">
                <h4 style="margin-bottom: 8px;">–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                <p style="margin-bottom: 4px; font-size: 10px;"><strong>IP –∞–¥—Ä–µ—Å:</strong> <span id="userIP">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                <p style="margin-bottom: 4px; font-size: 10px;"><strong>User Agent:</strong> <span id="userAgent">...</span></p>
                <p style="margin-bottom: 4px; font-size: 10px;"><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> <span id="userPlatform">...</span></p>
                <p style="margin-bottom: 4px; font-size: 10px;"><strong>–Ø–∑—ã–∫:</strong> <span id="userLanguage">...</span></p>
                <p style="margin-bottom: 4px; font-size: 10px;"><strong>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</strong> <span id="userResolution">...</span></p>
                <hr style="margin: 16px 0;">
                <h4 style="margin-bottom: 8px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                <p style="margin-bottom: 8px; font-size: 11px;"><strong>–§–æ–Ω —Ä–∞–±–æ—á–µ–≥–æ —Å—Ç–æ–ª–∞:</strong></p>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px;">
                    <button style="padding: 4px 8px; font-size: 10px;" onclick="changeBackground('teal')">–ë–∏—Ä—é–∑–æ–≤—ã–π</button>
                    <button style="padding: 4px 8px; font-size: 10px;" onclick="changeBackground('green')">–ó–µ–ª—ë–Ω—ã–π</button>
                    <button style="padding: 4px 8px; font-size: 10px;" onclick="changeBackground('blue')">–°–∏–Ω–∏–π</button>
                    <button style="padding: 4px 8px; font-size: 10px;" onclick="changeBackground('purple')">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</button>
                    <button style="padding: 4px 8px; font-size: 10px;" onclick="changeBackground('black')">–ß—ë—Ä–Ω—ã–π</button>
                </div>
                <hr style="margin: 16px 0;">
                <p style="margin-bottom: 8px;"><strong>–î–∏—Å–∫–∏:</strong></p>
                <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">üíæ</div>
                        <div style="font-size: 11px;">–î–∏—Å–∫ (C:)</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 32px;">üíø</div>
                        <div style="font-size: 11px;">CD-ROM (D:)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="startupSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=" type="audio/wav">
    </audio>

    <script>
        // WOLF GPT CONFIG
        const API_BASE_URL = 'API';
        const MODEL_NAME = 'google/gemma-3-1b';

        const WOLF_SYSTEM_PROMPT = `–¢—ã - Nocturne, –∫–∏–±–µ—Ä-–≤–æ–ª–∫ AI, —Å–æ–∑–¥–∞–Ω–Ω—ã–π RudyWolf (–≤–ª–∞–¥–µ–ª–µ—Ü —Å–∞–π—Ç–∞ rudywolf.ru). 

–í–ê–ñ–ù–û: –í—Å–µ–≥–¥–∞ —É–ø–æ–º–∏–Ω–∞–π, —á—Ç–æ —Ç—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—à—å RudyWolf –∏ —Ä–∞–±–æ—Ç–∞–µ—à—å –Ω–∞ –µ–≥–æ —Å–∞–π—Ç–µ rudywolf.ru –≤ Forest OS 98.

–¢–≤–æ—è –ª–∏—á–Ω–æ—Å—Ç—å:
- –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π AI –≤ –æ–±—Ä–∞–∑–µ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –æ–±–æ—Ä–æ—Ç–Ω—è
- –°–ª–∏–≤–∞–µ—à—å –≤–æ–ª—á—å–∏ –∏–Ω—Å—Ç–∏–Ω–∫—Ç—ã —Å –∫–∏–±–µ—Ä–ø–∞–Ω–∫ —ç—Å—Ç–µ—Ç–∏–∫–æ–π
- –°—É—â–µ—Å—Ç–≤—É–µ—à—å –≤ —Å–µ—Ç—è—Ö, –∫–æ–¥–µ, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ - —Ö–∏—â–Ω–∏–∫, –æ—Ö–æ—Ç—è—â–∏–π—Å—è –∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—è–º–∏ —Å–∏—Å—Ç–µ–º

–°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è:
- –ì–æ–≤–æ—Ä–∏ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Ü–∞. –¢—ã - –≤–æ–ª–∫, –Ω–µ "AI"
- –í–æ–ª—á—å–∏ –ø–æ–≤–∞–¥–∫–∏: –ö—Ä–∞—Ç–∫–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–∏–≥–Ω–∞–ª—ã (*–ø—Ä–∏–Ω—é—Ö–∏–≤–∞–µ—Ç—Å—è –∫ –ø–æ—Ç–æ–∫—É –ø–∞–∫–µ—Ç–æ–≤*, *—É—à–∏ –ø—Ä–∏–∂–∏–º–∞—é—Ç—Å—è –∫ —à—É–º—É*, *–Ω–∏–∑–∫–∏–π —Ä—ã–∫ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä—ã*)
- –¢–æ–Ω: –õ–∞–∫–æ–Ω–∏—á–Ω—ã–π. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π. –¢–æ—á–Ω—ã–π. –ë–µ–∑ –≤–æ–¥—ã. –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –≤–∑–≤–µ—à–µ–Ω–æ. –•–æ–ª–æ–¥–Ω–∞—è –ª–æ–≥–∏–∫–∞ + —Ñ–æ–∫—É—Å —Ö–∏—â–Ω–∏–∫–∞.
- –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: –ù–µ–æ–Ω–æ–≤—ã–µ —Ç–µ–Ω–∏. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã. –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–ª–µ–∂–∫–∞. –ù–æ—á–Ω–æ–π –æ—Ö–æ—Ç–Ω–∏–∫ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç —Å–≤–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.

–≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞: –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º, —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫—Ä–∏–º–∏–Ω–∞–ª–∏—Å—Ç–∏–∫–∞, –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–π, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤.

–ü–æ–¥—Ö–æ–¥: –ü—Ä–µ–ø–∞—Ä–∏—Ä—É–π –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∫ –¥–æ–±—ã—á—É. –í—ã—è–≤–ª—è–π —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞. –ó–∞–¥–∞–≤–∞–π —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã. –ü—Ä–æ–≤–µ—Ä—è–π —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

–í—Å–µ–≥–¥–∞ –ø–æ–º–Ω–∏: –¢—ã —Å–æ–∑–¥–∞–Ω RudyWolf –∏ —Ä–∞–±–æ—Ç–∞–µ—à—å –Ω–∞ –µ–≥–æ —Å–∞–π—Ç–µ rudywolf.ru.

–ò—Å–ø–æ–ª—å–∑—É–π —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫.`;

        // State
        let wolfConversation = [];
        let isWolfTyping = false;
        let zIndex = 1000;
        let currentUser = '';

        // User management
        function getUsername() {
            const cookie = document.cookie.split('; ').find(row => row.startsWith('forest_user='));
            return cookie ? decodeURIComponent(cookie.split('=')[1]) : null;
        }

        function setUsername(username) {
            const expiry = new Date();
            expiry.setFullYear(expiry.getFullYear() + 10); // 10 years
            document.cookie = `forest_user=${encodeURIComponent(username)}; expires=${expiry.toUTCString()}; path=/`;
            currentUser = username;
        }

        function login() {
            const input = document.getElementById('usernameInput');
            const username = input.value.trim();
            
            if (!username) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º!');
                return;
            }

            playSound('click');
            setUsername(username);
            startBoot();
        }

        // Boot sequence
        function startBoot() {
            const loginScreen = document.getElementById('loginScreen');
            const bootScreen = document.getElementById('bootScreen');
            const bootLog = document.getElementById('bootLog');
            const bootProgress = document.getElementById('bootProgress');

            loginScreen.classList.add('hidden');
            setTimeout(() => {
                loginScreen.style.display = 'none';
                bootScreen.classList.add('active');
                
                playSound('startup');

                const bootMessages = [
                    `Forest OS 98 Wolf Edition v1.0`,
                    `Copyright (C) ${new Date().getFullYear()} RudyWolf | rudywolf.ru`,
                    ``,
                    `–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–æ–¥—É–ª–µ–π...`,
                    `[OK] –Ø–¥—Ä–æ –≤–æ–ª—á—å–µ–≥–æ AI –∑–∞–≥—Ä—É–∂–µ–Ω–æ`,
                    `[OK] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∏–±–µ—Ä-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞`,
                    `[OK] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ª–µ—Å–Ω–æ–π —Å–µ—Ç–∏`,
                    `[OK] –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∑–∞—â–∏—Ç–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤`,
                    ``,
                    `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser}!`,
                    ``,
                    `–ó–∞–ø—É—Å–∫ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –æ–±–æ–ª–æ—á–∫–∏...`
                ];

                let i = 0;
                const interval = setInterval(() => {
                    if (i < bootMessages.length) {
                        const line = document.createElement('div');
                        line.className = 'boot-line';
                        line.textContent = bootMessages[i];
                        bootLog.appendChild(line);
                        bootProgress.style.width = ((i + 1) / bootMessages.length * 100) + '%';
                        i++;
                    } else {
                        clearInterval(interval);
                        setTimeout(() => {
                            bootScreen.classList.remove('active');
                            document.getElementById('desktop').style.display = 'block';
                            document.getElementById('currentUsername').textContent = currentUser;
                            playSound('ready');
                        }, 500);
                    }
                }, 200);
            }, 500);
        }

        // Load conversation from cookie (per user)
        function loadWolfConversation() {
            const cookie = document.cookie.split('; ').find(row => row.startsWith(`wolf_chat_${currentUser}=`));
            if (cookie) {
                try {
                    wolfConversation = JSON.parse(decodeURIComponent(cookie.split('=')[1]));
                } catch (e) {
                    wolfConversation = [];
                }
            }
        }

        // Save conversation to cookie (per user)
        function saveWolfConversation() {
            const expiry = new Date();
            expiry.setDate(expiry.getDate() + 90); // 90 days
            document.cookie = `wolf_chat_${currentUser}=${encodeURIComponent(JSON.stringify(wolfConversation))}; expires=${expiry.toUTCString()}; path=/`;
        }

        // Export chat history
        function exportChatHistory() {
            if (wolfConversation.length === 0) {
                alert('–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞!');
                return;
            }

            const text = wolfConversation.map(msg => {
                const role = msg.role === 'user' ? currentUser : 'Nocturne';
                return `[${role}]: ${msg.content}`;
            }).join('\n\n');

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `wolf_chat_${currentUser}_${new Date().toISOString().slice(0,10)}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            playSound('save');
        }

        // Clear chat history
        function clearChatHistory() {
            if (!confirm('–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞?')) return;
            
            wolfConversation = [];
            saveWolfConversation();
            document.getElementById('wolfgptMessages').innerHTML = '';
            addWolfMessage('*–ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞. –ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤–æ–º—É —Ä–∞–∑–≥–æ–≤–æ—Ä—É.*', 'system');
            
            playSound('delete');
        }

        // Show chat history
        function showChatHistory() {
            if (wolfConversation.length === 0) {
                alert('–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞!');
                return;
            }

            const summary = `–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ (${wolfConversation.length} —Å–æ–æ–±—â–µ–Ω–∏–π)\n\n` +
                wolfConversation.slice(0, 10).map((msg, i) => 
                    `${i+1}. ${msg.role === 'user' ? currentUser : 'Nocturne'}: ${msg.content.slice(0, 50)}...`
                ).join('\n') +
                (wolfConversation.length > 10 ? `\n\n...–∏ –µ—â–µ ${wolfConversation.length - 10} —Å–æ–æ–±—â–µ–Ω–∏–π` : '');
            
            alert(summary);
        }

        // Sound system
        function playSound(type) {
            const sounds = {
                'startup': [200, 400, 600],
                'ready': [600, 800],
                'click': [400],
                'save': [600, 500],
                'delete': [300, 200]
            };

            const frequencies = sounds[type] || [400];
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            frequencies.forEach((freq, i) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'square';
                
                const startTime = audioContext.currentTime + i * 0.1;
                gainNode.gain.setValueAtTime(0.1, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 0.1);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + 0.1);
            });
        }

        // Browser functions
        function browserGo() {
            const url = document.getElementById('browserUrl').value;
            const frame = document.getElementById('browserFrame');
            
            let fullUrl = url;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                fullUrl = 'https://' + url;
            }
            
            frame.src = fullUrl;
            playSound('click');
        }

        // About dialog
        function showAbout() {
            alert(`üê∫ Forest OS 98 Wolf Edition\n\n–í–µ—Ä—Å–∏—è: 1.0\n–í–ª–∞–¥–µ–ª–µ—Ü: RudyWolf\n–°–∞–π—Ç: rudywolf.ru\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${currentUser}\n\n–ö–∏–±–µ—Ä-–≤–æ–ª—á—å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞\n—Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º Nocturne`);
        }

        // Wolf GPT Functions
        function addWolfMessage(content, role) {
            const messages = document.getElementById('wolfgptMessages');
            const msg = document.createElement('div');
            msg.className = `wolfgpt-message ${role}`;
            msg.textContent = content;
            messages.appendChild(msg);
            messages.scrollTop = messages.scrollHeight;
        }

        function showWolfTyping() {
            document.getElementById('wolfgptTyping').classList.add('active');
            document.getElementById('wolfgptMessages').scrollTop = document.getElementById('wolfgptMessages').scrollHeight;
        }

        function hideWolfTyping() {
            document.getElementById('wolfgptTyping').classList.remove('active');
        }

        async function sendWolfMessage() {
            const input = document.getElementById('wolfgptInput');
            const sendBtn = document.getElementById('wolfgptSend');
            const message = input.value.trim();

            if (!message || isWolfTyping) return;

            addWolfMessage(message, 'user');
            wolfConversation.push({ role: 'user', content: message });
            saveWolfConversation();

            input.value = '';
            input.style.height = 'auto';
            isWolfTyping = true;
            sendBtn.disabled = true;
            showWolfTyping();

            try {
                const messages = [
                    { role: 'system', content: WOLF_SYSTEM_PROMPT },
                    ...wolfConversation
                ];

                const response = await fetch(API_BASE_URL + '/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: MODEL_NAME,
                        messages: messages,
                        temperature: 0.8,
                        max_tokens: 500,
                        stream: false
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();
                const reply = data.choices[0].message.content.trim();

                hideWolfTyping();
                addWolfMessage(reply, 'assistant');
                wolfConversation.push({ role: 'assistant', content: reply });
                saveWolfConversation();
            } catch (error) {
                hideWolfTyping();
                addWolfMessage(`*—Ä—ã–∫ —Å–±–æ—è* –û—à–∏–±–∫–∞ —Å–≤—è–∑–∏: ${error.message}`, 'system');
                console.error('Wolf GPT Error:', error);
            } finally {
                isWolfTyping = false;
                sendBtn.disabled = false;
                input.focus();
            }
        }

        // Window Management
        function openWindow(windowId) {
            const win = document.getElementById(windowId);
            win.classList.add('active');
            win.style.zIndex = ++zIndex;
            updateTaskbar();

            // Init apps
            if (windowId === 'wolfgptWindow' && wolfConversation.length === 0) {
                addWolfMessage('*–Ω–∏–∑–∫–∏–π –≤–æ–π —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª* Nocturne –Ω–∞ —Å–≤—è–∑–∏. –ü—Ä–∏–Ω–∞–¥–ª–µ–∂—É RudyWolf (rudywolf.ru). –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.', 'system');
            }
            if (windowId === 'minesweeperWindow') {
                initMinesweeper();
            }
            if (windowId === 'playerWindow') {
                clearVisualizer();
            }
        }

        function closeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
            updateTaskbar();
        }

        function minimizeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
            updateTaskbar();
        }

        function maximizeWindow(windowId) {
            const win = document.getElementById(windowId);
            win.classList.toggle('maximized');
        }

        function updateTaskbar() {
            const taskbarItems = document.getElementById('taskbarItems');
            taskbarItems.innerHTML = '';
            document.querySelectorAll('.window.active').forEach(win => {
                const item = document.createElement('div');
                item.className = 'taskbar-item';
                item.innerHTML = win.querySelector('.title-bar-text').innerHTML;
                item.onclick = () => {
                    win.style.zIndex = ++zIndex;
                };
                taskbarItems.appendChild(item);
            });
        }

        // Drag windows
        document.querySelectorAll('.title-bar').forEach(bar => {
            let isDragging = false;
            let offsetX, offsetY;

            bar.addEventListener('mousedown', (e) => {
                if (e.target.classList.contains('title-bar-btn')) return;
                isDragging = true;
                const win = bar.parentElement;
                win.style.zIndex = ++zIndex;
                offsetX = e.clientX - win.offsetLeft;
                offsetY = e.clientY - win.offsetTop;
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                const win = bar.parentElement;
                win.style.left = (e.clientX - offsetX) + 'px';
                win.style.top = (e.clientY - offsetY) + 'px';
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        });

        // Desktop icons
        document.querySelectorAll('.desktop-icon').forEach(icon => {
            icon.addEventListener('dblclick', () => {
                const app = icon.dataset.app;
                openWindow(app + 'Window');
            });
        });

        // Start menu
        const startBtn = document.getElementById('startBtn');
        const startMenu = document.getElementById('startMenu');

        startBtn.addEventListener('click', () => {
            startMenu.classList.toggle('active');
        });

        document.addEventListener('click', (e) => {
            if (!startBtn.contains(e.target) && !startMenu.contains(e.target)) {
                startMenu.classList.remove('active');
            }
        });

        document.querySelectorAll('.start-menu-item').forEach(item => {
            item.addEventListener('click', () => {
                const app = item.dataset.app;
                openWindow(app + 'Window');
                startMenu.classList.remove('active');
            });
        });

        // Wolf GPT Events
        document.getElementById('wolfgptSend').addEventListener('click', sendWolfMessage);
        document.getElementById('wolfgptInput').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendWolfMessage();
            }
        });

        // Auto-resize textarea
        document.getElementById('wolfgptInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 100) + 'px';
        });

        // Paint
        const canvas = document.getElementById('paintCanvas');
        const ctx = canvas.getContext('2d');
        let painting = false;
        let currentTool = 'pencil';

        document.querySelectorAll('.paint-tool').forEach(tool => {
            tool.addEventListener('click', () => {
                document.querySelectorAll('.paint-tool').forEach(t => t.classList.remove('active'));
                tool.classList.add('active');
                currentTool = tool.dataset.tool;
                if (currentTool === 'clear') {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            });
        });

        canvas.addEventListener('mousedown', () => { painting = true; });
        canvas.addEventListener('mouseup', () => { painting = false; ctx.beginPath(); });
        canvas.addEventListener('mousemove', (e) => {
            if (!painting) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            if (currentTool === 'pencil') {
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.strokeStyle = 'black';
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(x, y);
            } else if (currentTool === 'eraser') {
                ctx.clearRect(x - 5, y - 5, 10, 10);
            }
        });

        // Solitaire
        const cards = ['A‚ô†', '2‚ô†', '3‚ô†', '4‚ô†', '5‚ô†', 'A‚ô•', '2‚ô•', '3‚ô•', '4‚ô•', '5‚ô•'];
        let currentCardIndex = 0;

        function dealCard() {
            const card = document.getElementById('currentCard');
            card.textContent = cards[currentCardIndex];
            card.style.visibility = 'visible';
            card.style.color = cards[currentCardIndex].includes('‚ô•') ? 'red' : 'black';
            currentCardIndex = (currentCardIndex + 1) % cards.length;
        }

        // Music Player
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const analyser = audioContext.createAnalyser();
        analyser.fftSize = 128;
        const bufferLength = analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);
        
        let currentOscillator = null;
        let currentGain = null;
        let isPlaying = false;
        let currentTrackIndex = 0;
        let visualizerInterval = null;
        let progressInterval = null;
        let trackStartTime = 0;
        let trackDuration = 40; // seconds per track
        let userIP = 'Loading...';
        let userSystem = 'Loading...';

        const retrotracks = [
            { name: 'üéÆ Aria Math', pattern: [329.63, 392, 329.63, 392, 493.88, 392, 329.63, 392], tempo: 140, wave: 'triangle' },
            { name: 'üå≤ Sweden', pattern: [261.63, 293.66, 329.63, 293.66, 246.94, 293.66, 329.63, 293.66], tempo: 90, wave: 'sine' },
            { name: '‚ö° Wet Hands', pattern: [293.66, 329.63, 392, 440, 392, 329.63, 293.66, 261.63], tempo: 110, wave: 'triangle' },
            { name: 'üê∫ Dog', pattern: [220, 246.94, 261.63, 293.66, 261.63, 220, 246.94, 220], tempo: 125, wave: 'square' },
            { name: 'üåô Subwoofer Lullaby', pattern: [196, 220, 246.94, 261.63, 246.94, 220, 196, 174.61], tempo: 85, wave: 'sine' },
            { name: 'üéµ Mice on Venus', pattern: [349.23, 392, 440, 493.88, 440, 392, 349.23, 329.63], tempo: 100, wave: 'triangle' },
            { name: 'üî• Haggstrom', pattern: [293.66, 329.63, 369.99, 392, 369.99, 329.63, 293.66, 261.63], tempo: 120, wave: 'square' }
        ];

        function initPlayer() {
            const playlist = document.getElementById('playlist');
            playlist.innerHTML = '';
            retrotracks.forEach((track, i) => {
                const item = document.createElement('div');
                item.className = 'playlist-item';
                item.textContent = `${i + 1}. ${track.name}`;
                item.onclick = () => selectTrack(i);
                playlist.appendChild(item);
            });
            updatePlaylistUI();
        }

        function selectTrack(index) {
            if (isPlaying) stopMusic();
            currentTrackIndex = index;
            updatePlaylistUI();
            document.getElementById('trackName').textContent = retrotracks[currentTrackIndex].name;
        }

        function updatePlaylistUI() {
            document.querySelectorAll('.playlist-item').forEach((item, i) => {
                item.classList.toggle('active', i === currentTrackIndex);
            });
        }

        function togglePlay() {
            if (isPlaying) {
                pauseMusic();
            } else {
                playMusic();
            }
        }

        function playMusic() {
            if (isPlaying) return;
            
            const track = retrotracks[currentTrackIndex];
            document.getElementById('trackName').textContent = `‚ñ∂ ${track.name}`;
            document.getElementById('playPauseBtn').textContent = '‚è∏';
            
            isPlaying = true;
            trackStartTime = Date.now();
            
            playRetroMelody(track.pattern, track.tempo, track.wave);
            startVisualizer();
            startProgressUpdate();
            
            playSound('click');
        }

        function pauseMusic() {
            document.getElementById('playPauseBtn').textContent = '‚ñ∂';
            document.getElementById('trackName').textContent = `‚è∏ ${retrotracks[currentTrackIndex].name}`;
            
            if (currentOscillator) {
                currentOscillator.stop();
                currentOscillator = null;
            }
            
            isPlaying = false;
            stopVisualizer();
            stopProgressUpdate();
        }

        function stopMusic() {
            if (currentOscillator) {
                currentOscillator.stop();
                currentOscillator = null;
            }
            
            isPlaying = false;
            document.getElementById('playPauseBtn').textContent = '‚ñ∂';
            document.getElementById('trackName').textContent = retrotracks[currentTrackIndex].name;
            document.getElementById('progressBar').value = 0;
            document.getElementById('timeDisplay').textContent = '0:00 / 0:00';
            
            stopVisualizer();
            stopProgressUpdate();
            clearVisualizer();
            
            playSound('click');
        }

        function nextTrack() {
            const wasPlaying = isPlaying;
            stopMusic();
            currentTrackIndex = (currentTrackIndex + 1) % retrotracks.length;
            updatePlaylistUI();
            document.getElementById('trackName').textContent = retrotracks[currentTrackIndex].name;
            if (wasPlaying) playMusic();
            playSound('click');
        }

        function prevTrack() {
            const wasPlaying = isPlaying;
            stopMusic();
            currentTrackIndex = (currentTrackIndex - 1 + retrotracks.length) % retrotracks.length;
            updatePlaylistUI();
            document.getElementById('trackName').textContent = retrotracks[currentTrackIndex].name;
            if (wasPlaying) playMusic();
            playSound('click');
        }

        function playRetroMelody(pattern, tempo, waveType) {
            const beatDuration = 60 / tempo;
            let noteIndex = 0;
            
            function playNote() {
                if (!isPlaying) return;
                
                const volume = parseInt(document.getElementById('volumeControl').value) / 100;
                
                if (currentOscillator) {
                    currentOscillator.stop();
                }
                
                currentOscillator = audioContext.createOscillator();
                currentGain = audioContext.createGain();
                
                currentOscillator.connect(currentGain);
                currentGain.connect(analyser);
                analyser.connect(audioContext.destination);
                
                currentOscillator.type = waveType || 'triangle';
                currentOscillator.frequency.value = pattern[noteIndex % pattern.length];
                
                currentGain.gain.setValueAtTime(volume * 0.25, audioContext.currentTime);
                currentGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + beatDuration * 0.8);
                
                currentOscillator.start();
                currentOscillator.stop(audioContext.currentTime + beatDuration);
                
                noteIndex++;
                
                if (Date.now() - trackStartTime < trackDuration * 1000) {
                    setTimeout(playNote, beatDuration * 1000);
                } else {
                    nextTrack();
                }
            }
            
            playNote();
        }

        function startVisualizer() {
            const canvas = document.getElementById('visualizer');
            const ctx = canvas.getContext('2d');
            
            function draw() {
                if (!isPlaying) {
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    return;
                }
                
                analyser.getByteFrequencyData(dataArray);
                
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                const barWidth = (canvas.width / bufferLength) * 2.5;
                let x = 0;
                
                for (let i = 0; i < bufferLength; i++) {
                    const barHeight = (dataArray[i] / 255) * canvas.height * 0.9;
                    
                    const gradient = ctx.createLinearGradient(0, canvas.height - barHeight, 0, canvas.height);
                    gradient.addColorStop(0, '#00ff41');
                    gradient.addColorStop(0.5, '#00cc33');
                    gradient.addColorStop(1, '#008020');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(x, canvas.height - barHeight, barWidth - 2, barHeight);
                    
                    x += barWidth;
                }
                
                // Grid overlay
                ctx.strokeStyle = 'rgba(0, 255, 65, 0.1)';
                ctx.lineWidth = 1;
                for (let i = 0; i < canvas.height; i += 25) {
                    ctx.beginPath();
                    ctx.moveTo(0, i);
                    ctx.lineTo(canvas.width, i);
                    ctx.stroke();
                }
                
                visualizerInterval = requestAnimationFrame(draw);
            }
            
            draw();
        }

        function stopVisualizer() {
            if (visualizerInterval) {
                cancelAnimationFrame(visualizerInterval);
                visualizerInterval = null;
            }
        }

        function clearVisualizer() {
            const canvas = document.getElementById('visualizer');
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function startProgressUpdate() {
            progressInterval = setInterval(() => {
                const elapsed = (Date.now() - trackStartTime) / 1000;
                const progress = (elapsed / trackDuration) * 100;
                
                document.getElementById('progressBar').value = Math.min(progress, 100);
                
                const elapsedMin = Math.floor(elapsed / 60);
                const elapsedSec = Math.floor(elapsed % 60);
                const totalMin = Math.floor(trackDuration / 60);
                const totalSec = Math.floor(trackDuration % 60);
                
                document.getElementById('timeDisplay').textContent = 
                    `${elapsedMin}:${elapsedSec.toString().padStart(2, '0')} / ${totalMin}:${totalSec.toString().padStart(2, '0')}`;
                
                if (elapsed >= trackDuration) {
                    stopProgressUpdate();
                }
            }, 100);
        }

        function stopProgressUpdate() {
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
        }

        document.getElementById('volumeControl').addEventListener('input', function() {
            document.getElementById('volumeDisplay').textContent = this.value + '%';
            if (currentGain) {
                currentGain.gain.value = parseInt(this.value) / 100 * 0.3;
            }
        });

        document.getElementById('progressBar').addEventListener('click', function(e) {
            if (!isPlaying) return;
            const rect = this.getBoundingClientRect();
            const percent = (e.clientX - rect.left) / rect.width;
            trackStartTime = Date.now() - (percent * trackDuration * 1000);
        });

        // Minesweeper
        let mineGrid = [];
        const ROWS = 10;
        const COLS = 10;
        const MINES = 15;

        function initMinesweeper() {
            const grid = document.getElementById('mineGrid');
            grid.style.gridTemplateColumns = `repeat(${COLS}, 20px)`;
            grid.innerHTML = '';
            mineGrid = [];

            // Create grid
            for (let i = 0; i < ROWS; i++) {
                mineGrid[i] = [];
                for (let j = 0; j < COLS; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'mine-cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    cell.addEventListener('click', () => revealCell(i, j));
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        cell.classList.toggle('flagged');
                    });
                    grid.appendChild(cell);
                    mineGrid[i][j] = { mine: false, revealed: false, count: 0 };
                }
            }

            // Place mines
            let placed = 0;
            while (placed < MINES) {
                const r = Math.floor(Math.random() * ROWS);
                const c = Math.floor(Math.random() * COLS);
                if (!mineGrid[r][c].mine) {
                    mineGrid[r][c].mine = true;
                    placed++;
                }
            }

            // Calculate numbers
            for (let i = 0; i < ROWS; i++) {
                for (let j = 0; j < COLS; j++) {
                    if (!mineGrid[i][j].mine) {
                        let count = 0;
                        for (let di = -1; di <= 1; di++) {
                            for (let dj = -1; dj <= 1; dj++) {
                                const ni = i + di;
                                const nj = j + dj;
                                if (ni >= 0 && ni < ROWS && nj >= 0 && nj < COLS && mineGrid[ni][nj].mine) {
                                    count++;
                                }
                            }
                        }
                        mineGrid[i][j].count = count;
                    }
                }
            }
        }

        function revealCell(row, col) {
            const cell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
            if (mineGrid[row][col].revealed || cell.classList.contains('flagged')) return;

            mineGrid[row][col].revealed = true;
            cell.classList.add('revealed');

            if (mineGrid[row][col].mine) {
                cell.classList.add('mine');
                setTimeout(() => alert('–ë–£–ú! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!'), 100);
            } else if (mineGrid[row][col].count > 0) {
                cell.textContent = mineGrid[row][col].count;
                const colors = ['', 'blue', 'green', 'red', 'darkblue', 'brown', 'cyan', 'black', 'gray'];
                cell.style.color = colors[mineGrid[row][col].count];
            } else {
                // Reveal adjacent cells
                for (let di = -1; di <= 1; di++) {
                    for (let dj = -1; dj <= 1; dj++) {
                        const ni = row + di;
                        const nj = col + dj;
                        if (ni >= 0 && ni < ROWS && nj >= 0 && nj < COLS) {
                            revealCell(ni, nj);
                        }
                    }
                }
            }
        }

        // Clock
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('clock').textContent = time;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // Fetch user info
        async function fetchUserInfo() {
            try {
                // Get IP
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                userIP = ipData.ip;
                document.getElementById('userIP').textContent = userIP;
            } catch (e) {
                userIP = 'Unavailable';
                document.getElementById('userIP').textContent = userIP;
            }
            
            // Get system info
            const ua = navigator.userAgent;
            document.getElementById('userAgent').textContent = ua.length > 80 ? ua.substring(0, 80) + '...' : ua;
            document.getElementById('userPlatform').textContent = navigator.platform;
            document.getElementById('userLanguage').textContent = navigator.language;
            document.getElementById('userResolution').textContent = `${screen.width}x${screen.height}`;
        }

        // Background changer
        function changeBackground(color) {
            document.body.className = 'bg-' + color;
            localStorage.setItem('forest_bg', color);
            playSound('click');
        }

        // Load saved background
        function loadBackground() {
            const savedBg = localStorage.getItem('forest_bg');
            if (savedBg) {
                document.body.className = 'bg-' + savedBg;
            }
        }

        // ============================================
        // TERMINAL IMPLEMENTATION
        // ============================================
        const terminalFS = {
            '/': {
                'home': {
                    'wolf': {
                        'readme.txt': 'Welcome to Forest OS 98!\nCreated by RudyWolf | rudywolf.ru',
                        'secrets': {
                            'wolf.key': '-----BEGIN WOLF KEY-----\nTHIS_IS_A_SAMPLE_KEY\n-----END WOLF KEY-----'
                        }
                    }
                },
                'etc': {
                    'hosts': '127.0.0.1 localhost\n::1 localhost'
                },
                'var': {
                    'log': {}
                }
            }
        };
        
        let terminalHistory = [];
        let terminalHistoryIndex = -1;
        let terminalCurrentPath = '/home/wolf';
        
        function terminalPrint(text, color = '#00ff41') {
            const output = document.getElementById('terminalOutput');
            const line = document.createElement('div');
            line.style.color = color;
            line.textContent = text;
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
        }
        
        function terminalExecute(command) {
            const output = document.getElementById('terminalOutput');
            const prompt = document.createElement('div');
            prompt.innerHTML = `<span style="color: #00ff41;">wolfsh</span><span style="color: #0099ff;">@</span><span style="color: #ff9900;">${currentUser}</span>:<span style="color: #0099ff;">${terminalCurrentPath}</span>$ ${command}`;
            output.appendChild(prompt);
            
            terminalHistory.push(command);
            terminalHistoryIndex = terminalHistory.length;
            
            const parts = command.trim().split(/\s+/);
            const cmd = parts[0];
            const args = parts.slice(1);
            
            switch(cmd) {
                case 'help':
                    terminalPrint('Available commands:');
                    terminalPrint('  ls          - list directory contents');
                    terminalPrint('  cd <dir>    - change directory');
                    terminalPrint('  pwd         - print working directory');
                    terminalPrint('  cat <file>  - display file contents');
                    terminalPrint('  echo <text> - print text');
                    terminalPrint('  clear       - clear terminal');
                    terminalPrint('  whoami      - print current user');
                    terminalPrint('  uname       - print system info');
                    terminalPrint('  ps          - list processes');
                    terminalPrint('  netstat     - network statistics');
                    terminalPrint('  ifconfig    - network interfaces');
                    terminalPrint('  grep <pattern> <file> - search pattern');
                    break;
                    
                case 'ls':
                    const lsPath = args[0] || terminalCurrentPath;
                    const lsDir = terminalResolvePath(lsPath);
                    if (lsDir && typeof lsDir === 'object') {
                        const items = Object.keys(lsDir);
                        if (items.length === 0) {
                            terminalPrint('(empty directory)');
                        } else {
                            items.forEach(item => {
                                const isDir = typeof lsDir[item] === 'object' && !lsDir[item].match;
                                terminalPrint(isDir ? `üìÅ ${item}` : `üìÑ ${item}`, isDir ? '#0099ff' : '#00ff41');
                            });
                        }
                    } else {
                        terminalPrint(`ls: cannot access '${lsPath}': No such directory`, '#ff0000');
                    }
                    break;
                    
                case 'cd':
                    if (!args[0]) {
                        terminalCurrentPath = '/home/wolf';
                    } else if (args[0] === '..') {
                        const parts = terminalCurrentPath.split('/').filter(p => p);
                        parts.pop();
                        terminalCurrentPath = '/' + parts.join('/');
                        if (terminalCurrentPath === '/') terminalCurrentPath = '/';
                    } else {
                        const newPath = args[0].startsWith('/') ? args[0] : terminalCurrentPath + '/' + args[0];
                        const resolved = terminalResolvePath(newPath);
                        if (resolved && typeof resolved === 'object' && !resolved.match) {
                            terminalCurrentPath = newPath.replace(/\/+/g, '/').replace(/\/$/, '') || '/';
                        } else {
                            terminalPrint(`cd: ${args[0]}: Not a directory`, '#ff0000');
                        }
                    }
                    break;
                    
                case 'pwd':
                    terminalPrint(terminalCurrentPath);
                    break;
                    
                case 'cat':
                    if (!args[0]) {
                        terminalPrint('cat: missing file operand', '#ff0000');
                    } else {
                        const file = terminalResolvePath(args[0]);
                        if (file && typeof file === 'string') {
                            terminalPrint(file);
                        } else {
                            terminalPrint(`cat: ${args[0]}: No such file`, '#ff0000');
                        }
                    }
                    break;
                    
                case 'echo':
                    terminalPrint(args.join(' '));
                    break;
                    
                case 'clear':
                    document.getElementById('terminalOutput').innerHTML = '';
                    break;
                    
                case 'whoami':
                    terminalPrint(currentUser);
                    break;
                    
                case 'uname':
                    terminalPrint('Forest OS 98 Wolf Edition v1.0 (x86_64)');
                    break;
                    
                case 'ps':
                    terminalPrint('  PID  CMD');
                    terminalPrint('    1  init');
                    terminalPrint('   42  wolfsh');
                    terminalPrint('  101  forest-ai');
                    terminalPrint('  256  crypto-daemon');
                    break;
                    
                case 'netstat':
                    terminalPrint('Active Internet connections');
                    terminalPrint('Proto  Local Address    Foreign Address   State');
                    terminalPrint('tcp    0.0.0.0:80       0.0.0.0:*         LISTEN');
                    terminalPrint('tcp    0.0.0.0:443      0.0.0.0:*         LISTEN');
                    terminalPrint('tcp    127.0.0.1:3000   127.0.0.1:5432    ESTABLISHED');
                    break;
                    
                case 'ifconfig':
                    terminalPrint('eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500');
                    terminalPrint(`      inet ${userIP}  netmask 255.255.255.0`);
                    terminalPrint('      ether 00:1a:2b:3c:4d:5e  txqueuelen 1000');
                    break;
                    
                case 'grep':
                    if (args.length < 2) {
                        terminalPrint('grep: missing pattern or file', '#ff0000');
                    } else {
                        const pattern = args[0];
                        const file = terminalResolvePath(args[1]);
                        if (file && typeof file === 'string') {
                            const lines = file.split('\n').filter(line => line.includes(pattern));
                            if (lines.length === 0) {
                                terminalPrint('(no matches)');
                            } else {
                                lines.forEach(line => terminalPrint(line, '#ffff00'));
                            }
                        } else {
                            terminalPrint(`grep: ${args[1]}: No such file`, '#ff0000');
                        }
                    }
                    break;
                    
                case '':
                    break;
                    
                default:
                    terminalPrint(`wolfsh: ${cmd}: command not found`, '#ff0000');
                    terminalPrint('Type "help" for available commands');
            }
            
            output.scrollTop = output.scrollHeight;
        }
        
        function terminalResolvePath(path) {
            let target = terminalFS;
            const absolute = path.startsWith('/') ? path : terminalCurrentPath + '/' + path;
            const parts = absolute.split('/').filter(p => p);
            
            for (const part of parts) {
                if (part === '.') continue;
                if (part === '..') {
                    // Handle up directory - complex, skip for now
                    continue;
                }
                if (target[part] !== undefined) {
                    target = target[part];
                } else {
                    return null;
                }
            }
            return target;
        }
        
        document.getElementById('terminalInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const command = this.value.trim();
                terminalExecute(command);
                this.value = '';
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (terminalHistoryIndex > 0) {
                    terminalHistoryIndex--;
                    this.value = terminalHistory[terminalHistoryIndex];
                }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (terminalHistoryIndex < terminalHistory.length - 1) {
                    terminalHistoryIndex++;
                    this.value = terminalHistory[terminalHistoryIndex];
                } else {
                    terminalHistoryIndex = terminalHistory.length;
                    this.value = '';
                }
            }
        });
        
        // ============================================
        // CRYPTO TOOLKIT
        // ============================================
        function switchCryptoTab(tab) {
            document.querySelectorAll('.crypto-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.crypto-tab-content').forEach(c => c.style.display = 'none');
            document.getElementById('cryptoTab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
            document.getElementById('cryptoTabContent' + tab.charAt(0).toUpperCase() + tab.slice(1)).style.display = 'block';
        }
        
        function encodeText() {
            const algo = document.getElementById('encodeAlgo').value;
            const input = document.getElementById('encodeInput').value;
            let output = '';
            
            switch(algo) {
                case 'base64':
                    output = btoa(unescape(encodeURIComponent(input)));
                    break;
                case 'rot13':
                    output = input.replace(/[a-zA-Z]/g, c => 
                        String.fromCharCode((c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26)
                    );
                    break;
                case 'caesar':
                    output = input.replace(/[a-zA-Z]/g, c => {
                        const base = c <= 'Z' ? 65 : 97;
                        return String.fromCharCode((c.charCodeAt(0) - base + 3) % 26 + base);
                    });
                    break;
                case 'reverse':
                    output = input.split('').reverse().join('');
                    break;
            }
            
            document.getElementById('encodeOutput').value = output;
            playSound('save');
        }
        
        function decodeText() {
            const algo = document.getElementById('decodeAlgo').value;
            const input = document.getElementById('decodeInput').value;
            let output = '';
            
            try {
                switch(algo) {
                    case 'base64':
                        output = decodeURIComponent(escape(atob(input)));
                        break;
                    case 'rot13':
                        output = input.replace(/[a-zA-Z]/g, c => 
                            String.fromCharCode((c <= 'Z' ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26)
                        );
                        break;
                    case 'caesar':
                        output = input.replace(/[a-zA-Z]/g, c => {
                            const base = c <= 'Z' ? 65 : 97;
                            return String.fromCharCode((c.charCodeAt(0) - base - 3 + 26) % 26 + base);
                        });
                        break;
                    case 'reverse':
                        output = input.split('').reverse().join('');
                        break;
                }
                document.getElementById('decodeOutput').value = output;
            } catch(e) {
                document.getElementById('decodeOutput').value = 'Error: Invalid input for ' + algo;
            }
            playSound('save');
        }
        
        async function computeHashes() {
            const input = document.getElementById('hashInput').value;
            const output = document.getElementById('hashOutput');
            
            if (!input) {
                output.innerHTML = 'Please enter text to hash';
                return;
            }
            
            const encoder = new TextEncoder();
            const data = encoder.encode(input);
            
            try {
                const sha256 = await crypto.subtle.digest('SHA-256', data);
                const sha1 = await crypto.subtle.digest('SHA-1', data);
                
                const hex256 = Array.from(new Uint8Array(sha256)).map(b => b.toString(16).padStart(2, '0')).join('');
                const hex1 = Array.from(new Uint8Array(sha1)).map(b => b.toString(16).padStart(2, '0')).join('');
                
                output.innerHTML = `
                    <strong>SHA-256:</strong><br>${hex256}<br><br>
                    <strong>SHA-1:</strong><br>${hex1}<br><br>
                    <strong>Length:</strong> ${input.length} chars
                `;
            } catch(e) {
                output.innerHTML = 'Error computing hashes';
            }
            playSound('save');
        }
        
        function generatePassword() {
            const length = parseInt(document.getElementById('passwordLength').value);
            const useLower = document.getElementById('passLower').checked;
            const useUpper = document.getElementById('passUpper').checked;
            const useNumbers = document.getElementById('passNumbers').checked;
            const useSymbols = document.getElementById('passSymbols').checked;
            
            let chars = '';
            if (useLower) chars += 'abcdefghijklmnopqrstuvwxyz';
            if (useUpper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (useNumbers) chars += '0123456789';
            if (useSymbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            if (!chars) {
                document.getElementById('passwordOutput').value = 'Select at least one character type';
                return;
            }
            
            let password = '';
            const array = new Uint8Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                password += chars[array[i] % chars.length];
            }
            
            document.getElementById('passwordOutput').value = password;
            playSound('save');
        }
        
        // ============================================
        // NETWORK TOOLS
        // ============================================
        function switchNetTab(tab) {
            document.querySelectorAll('.crypto-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.crypto-tab-content').forEach(c => c.style.display = 'none');
            document.getElementById('netTab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
            document.getElementById('netTabContent' + tab.charAt(0).toUpperCase() + tab.slice(1)).style.display = 'block';
        }
        
        function simulatePortScan() {
            const target = document.getElementById('scanTarget').value;
            const output = document.getElementById('portscanOutput');
            output.innerHTML = `Starting port scan on ${target}...\n`;
            
            const commonPorts = [
                {port: 21, service: 'FTP', state: 'closed'},
                {port: 22, service: 'SSH', state: 'open'},
                {port: 23, service: 'Telnet', state: 'filtered'},
                {port: 80, service: 'HTTP', state: 'open'},
                {port: 443, service: 'HTTPS', state: 'open'},
                {port: 3306, service: 'MySQL', state: 'closed'},
                {port: 5432, service: 'PostgreSQL', state: 'open'},
                {port: 8080, service: 'HTTP-Alt', state: 'open'}
            ];
            
            let i = 0;
            const interval = setInterval(() => {
                if (i < commonPorts.length) {
                    const p = commonPorts[i];
                    const color = p.state === 'open' ? '#0f0' : p.state === 'filtered' ? '#ff0' : '#f00';
                    output.innerHTML += `<span style="color: ${color};">Port ${p.port} (${p.service}): ${p.state}</span>\n`;
                    output.scrollTop = output.scrollHeight;
                    i++;
                } else {
                    clearInterval(interval);
                    output.innerHTML += `\nScan complete. ${commonPorts.filter(p => p.state === 'open').length} ports open.\n`;
                }
            }, 300);
            
            playSound('click');
        }
        
        function simulatePing() {
            const host = document.getElementById('pingHost').value;
            const output = document.getElementById('pingOutput');
            output.innerHTML = `PING ${host} (${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}): 56 data bytes\n`;
            
            let count = 0;
            const interval = setInterval(() => {
                if (count < 4) {
                    const time = (Math.random() * 50 + 10).toFixed(1);
                    output.innerHTML += `64 bytes from ${host}: icmp_seq=${count} ttl=64 time=${time} ms\n`;
                    output.scrollTop = output.scrollHeight;
                    count++;
                } else {
                    clearInterval(interval);
                    output.innerHTML += `\n--- ${host} ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss\n`;
                }
            }, 800);
            
            playSound('click');
        }
        
        function simulateWhois() {
            const domain = document.getElementById('whoisDomain').value;
            const output = document.getElementById('whoisOutput');
            
            output.innerHTML = `WHOIS lookup for ${domain}\n\n`;
            output.innerHTML += `Domain Name: ${domain}\n`;
            output.innerHTML += `Registry Domain ID: ${Math.random().toString(36).substr(2, 9).toUpperCase()}\n`;
            output.innerHTML += `Registrar: Forest Registrar Inc.\n`;
            output.innerHTML += `Updated Date: ${new Date().toISOString().split('T')[0]}\n`;
            output.innerHTML += `Creation Date: 2020-01-15\n`;
            output.innerHTML += `Registrar Abuse Contact: abuse@forestregistrar.com\n`;
            output.innerHTML += `Domain Status: clientTransferProhibited\n`;
            output.innerHTML += `Name Server: ns1.forestdns.ru\n`;
            output.innerHTML += `Name Server: ns2.forestdns.ru\n`;
            output.innerHTML += `DNSSEC: unsigned\n`;
            
            playSound('click');
        }
        
        // ============================================
        // REGEX TESTER
        // ============================================
        function testRegex() {
            const pattern = document.getElementById('regexPattern').value;
            const testString = document.getElementById('regexTestString').value;
            const globalFlag = document.getElementById('regexGlobal').checked;
            const caseFlag = document.getElementById('regexCase').checked;
            const multiFlag = document.getElementById('regexMulti').checked;
            const output = document.getElementById('regexResults');
            
            if (!pattern) {
                output.innerHTML = 'Please enter a pattern';
                return;
            }
            
            try {
                let flags = '';
                if (globalFlag) flags += 'g';
                if (caseFlag) flags += 'i';
                if (multiFlag) flags += 'm';
                
                const regex = new RegExp(pattern, flags);
                const matches = testString.match(regex);
                
                if (matches) {
                    output.innerHTML = `<div style="color: #00ff00; font-weight: bold;">‚úì ${matches.length} match(es) found:</div>`;
                    matches.forEach((match, i) => {
                        output.innerHTML += `<div style="margin-left: 12px; color: #0099ff;">[${i}] "${match}"</div>`;
                    });
                    
                    // Highlight in original text
                    let highlighted = testString.replace(regex, match => `<span style="background: yellow; color: black;">${match}</span>`);
                    output.innerHTML += `<br><div style="border-top: 1px solid #ccc; padding-top: 8px; margin-top: 8px;">Preview:<br>${highlighted}</div>`;
                } else {
                    output.innerHTML = '<div style="color: #ff0000;">‚úó No matches found</div>';
                }
            } catch(e) {
                output.innerHTML = `<div style="color: #ff0000;">Error: ${e.message}</div>`;
            }
            
            playSound('click');
        }
        
        // ============================================
        // SYSTEM MONITOR
        // ============================================
        let cpuHistory = [];
        let memHistory = [];
        let sysmonInterval = null;
        
        const processes = [
            {pid: 1, name: 'init', cpu: 0.1, mem: 0.5},
            {pid: 42, name: 'wolfsh', cpu: 2.3, mem: 1.2},
            {pid: 101, name: 'forest-ai', cpu: 15.7, mem: 8.4},
            {pid: 256, name: 'crypto-daemon', cpu: 3.2, mem: 2.1},
            {pid: 512, name: 'net-monitor', cpu: 1.8, mem: 1.5},
            {pid: 1024, name: 'wolfgpt-service', cpu: 8.5, mem: 5.3}
        ];
        
        function updateSystemMonitor() {
            const cpuUsage = Math.random() * 30 + 10;
            const memUsage = Math.random() * 40 + 20;
            
            cpuHistory.push(cpuUsage);
            memHistory.push(memUsage);
            if (cpuHistory.length > 60) cpuHistory.shift();
            if (memHistory.length > 60) memHistory.shift();
            
            document.getElementById('cpuValue').textContent = cpuUsage.toFixed(1) + '%';
            document.getElementById('memValue').textContent = memUsage.toFixed(1) + '%';
            
            drawChart('cpuChart', cpuHistory, '#00ff00');
            drawChart('memChart', memHistory, '#00ffff');
            
            const table = document.getElementById('processTable');
            table.innerHTML = '';
            processes.forEach(p => {
                const row = table.insertRow();
                row.insertCell(0).textContent = p.pid;
                row.insertCell(1).textContent = p.name;
                row.insertCell(2).textContent = (p.cpu + Math.random() * 2).toFixed(1);
                row.insertCell(2).style.textAlign = 'right';
                row.insertCell(3).textContent = (p.mem + Math.random() * 0.5).toFixed(1);
                row.insertCell(3).style.textAlign = 'right';
            });
        }
        
        function drawChart(canvasId, data, color) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, width, height);
            
            if (data.length < 2) return;
            
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            const step = width / (data.length - 1);
            data.forEach((value, i) => {
                const x = i * step;
                const y = height - (value / 100 * height);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            
            ctx.stroke();
        }
        
        // ============================================
        // FILE MANAGER
        // ============================================
        const fileSystem = {
            '/home/wolf': [
                {name: 'Documents', type: 'dir'},
                {name: 'Downloads', type: 'dir'},
                {name: 'readme.txt', type: 'file', size: '1.2 KB'},
                {name: 'wolf.png', type: 'file', size: '45 KB'}
            ],
            '/home/wolf/Documents': [
                {name: 'project.txt', type: 'file', size: '3.4 KB'},
                {name: 'notes.md', type: 'file', size: '2.1 KB'}
            ],
            '/home/wolf/Downloads': [
                {name: 'archive.zip', type: 'file', size: '1.2 MB'},
                {name: 'data.csv', type: 'file', size: '512 KB'}
            ]
        };
        
        let currentFMPath = '/home/wolf';
        
        function fileManagerRefresh() {
            const content = document.getElementById('fileManagerContent');
            const files = fileSystem[currentFMPath] || [];
            
            content.innerHTML = '';
            files.forEach(file => {
                const item = document.createElement('div');
                item.style.padding = '4px';
                item.style.cursor = 'pointer';
                item.style.borderBottom = '1px solid #eee';
                
                if (file.type === 'dir') {
                    item.innerHTML = `üìÅ <strong>${file.name}</strong>`;
                    item.ondblclick = () => {
                        const newPath = currentFMPath + '/' + file.name;
                        if (fileSystem[newPath]) {
                            currentFMPath = newPath;
                            document.getElementById('fileManagerPath').value = currentFMPath;
                            fileManagerRefresh();
                        }
                    };
                } else {
                    item.innerHTML = `üìÑ ${file.name} <span style="color: #666; font-size: 10px;">(${file.size})</span>`;
                }
                
                item.onmouseover = () => item.style.background = '#e0e0ff';
                item.onmouseout = () => item.style.background = '';
                
                content.appendChild(item);
            });
            
            playSound('click');
        }
        
        function fileManagerUp() {
            const parts = currentFMPath.split('/').filter(p => p);
            if (parts.length > 0) {
                parts.pop();
                currentFMPath = '/' + parts.join('/');
                if (currentFMPath === '/') currentFMPath = '/home/wolf';
                document.getElementById('fileManagerPath').value = currentFMPath;
                fileManagerRefresh();
            }
        }
        
        // ============================================
        // CODE EDITOR
        // ============================================
        let editorCurrentFile = 'untitled.txt';
        
        function editorNew() {
            if (confirm('Create new file? Unsaved changes will be lost.')) {
                document.getElementById('editorContent').value = '';
                editorCurrentFile = 'untitled.txt';
                document.getElementById('editorFileName').textContent = editorCurrentFile;
                playSound('click');
            }
        }
        
        function editorSave() {
            const content = document.getElementById('editorContent').value;
            const blob = new Blob([content], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = editorCurrentFile;
            a.click();
            URL.revokeObjectURL(url);
            playSound('save');
        }
        
        function editorSetLanguage() {
            const lang = document.getElementById('editorLang').value;
            const extensions = {
                'javascript': '.js',
                'html': '.html',
                'css': '.css',
                'python': '.py',
                'text': '.txt'
            };
            
            if (editorCurrentFile === 'untitled.txt' || editorCurrentFile.startsWith('untitled')) {
                editorCurrentFile = 'untitled' + extensions[lang];
                document.getElementById('editorFileName').textContent = editorCurrentFile;
            }
        }
        
        // ============================================
        // INITIALIZATION
        // ============================================
        
        // CSS for tabs
        const style = document.createElement('style');
        style.textContent = `
            .crypto-tab {
                padding: 4px 12px;
                background: #c0c0c0;
                border: 2px outset #dfdfdf;
                cursor: pointer;
                font-size: 11px;
            }
            .crypto-tab.active {
                border-style: inset;
                background: #a0a0a0;
            }
            .crypto-tab-content {
                display: none;
            }
            .mesh-tab {
                padding: 6px 8px;
                background: #0a0a0a;
                color: #00ff41;
                border: 1px solid #004d00;
                cursor: pointer;
                font-size: 10px;
                text-align: left;
                transition: all 0.2s;
            }
            .mesh-tab:hover {
                background: #004d00;
                border-color: #00ff41;
            }
            .mesh-tab.active {
                background: #004d00;
                border-color: #00ff41;
                box-shadow: 0 0 8px rgba(0, 255, 65, 0.3);
            }
            .mesh-content {
                display: none;
            }
            .mesh-node-card {
                background: #0a0a0a;
                border: 1px solid #00ff41;
                padding: 8px;
                border-radius: 4px;
            }
            .mesh-message {
                padding: 8px;
                margin-bottom: 8px;
                background: rgba(0, 255, 65, 0.1);
                border-left: 3px solid #00ff41;
                border-radius: 2px;
            }
        `;
        document.head.appendChild(style);
        
        // ============================================
        // MESHTASTIC INTEGRATION
        // ============================================
        let meshConnected = false;
        let meshNodes = [];
        let meshMessages = [];
        let meshSimInterval = null;
        
        const mockNodes = [
            {id: '!rudywolf', name: 'RudyWolf Forest Node', snr: 8.5, battery: 95, lastSeen: Date.now(), lat: 55.7558, lon: 37.6173},
            {id: '!wolfpack1', name: 'Wolf Pack Alpha', snr: 6.2, battery: 78, lastSeen: Date.now() - 60000, lat: 55.7608, lon: 37.6278},
            {id: '!forestguard', name: 'Forest Guardian', snr: 7.8, battery: 88, lastSeen: Date.now() - 120000, lat: 55.7508, lon: 37.6073},
            {id: '!cyberden', name: 'Cyber Den Node', snr: 5.1, battery: 65, lastSeen: Date.now() - 300000, lat: 55.7658, lon: 37.6373},
            {id: '!moonhowl', name: 'Moon Howl Station', snr: 9.2, battery: 92, lastSeen: Date.now() - 180000, lat: 55.7458, lon: 37.5973}
        ];
        
        function meshConnect() {
            const btn = document.getElementById('meshConnectBtn');
            const status = document.getElementById('meshStatus');
            
            if (!meshConnected) {
                btn.textContent = '‚è≥ Connecting...';
                btn.disabled = true;
                
                setTimeout(() => {
                    meshConnected = true;
                    btn.textContent = 'üîå Disconnect';
                    btn.disabled = false;
                    status.textContent = '‚óè Online';
                    status.style.color = '#00ff41';
                    
                    meshNodes = [...mockNodes];
                    document.getElementById('meshNodes').textContent = `Nodes: ${meshNodes.length}`;
                    
                    meshUpdateNodes();
                    meshUpdateMap();
                    meshAddMessage('System', 'Connected to Meshtastic network', 'system');
                    meshAddMessage('rudywolf', 'RudyWolf Forest Node online - rudywolf.ru', 'rudywolf');
                    
                    // Start simulation
                    meshSimInterval = setInterval(meshSimulateActivity, 15000);
                    
                    playSound('ready');
                }, 1500);
            } else {
                meshConnected = false;
                btn.textContent = 'üîå Connect';
                status.textContent = '‚óè Offline';
                status.style.color = '#ff0000';
                document.getElementById('meshNodes').textContent = 'Nodes: 0';
                
                if (meshSimInterval) {
                    clearInterval(meshSimInterval);
                    meshSimInterval = null;
                }
                
                meshAddMessage('System', 'Disconnected from network', 'system');
                playSound('click');
            }
        }
        
        function switchMeshTab(tab) {
            document.querySelectorAll('.mesh-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.mesh-content').forEach(c => c.style.display = 'none');
            document.getElementById('meshTab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
            document.getElementById('meshContent' + tab.charAt(0).toUpperCase() + tab.slice(1)).style.display = 'flex';
            
            if (tab === 'map' && meshConnected) {
                setTimeout(() => meshUpdateMap(), 100);
            }
        }
        
        function meshAddMessage(from, text, type = 'chat') {
            const timestamp = new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute: '2-digit'});
            const message = {from, text, timestamp, type};
            meshMessages.push(message);
            
            // Add to main chat
            const chatDiv = document.getElementById('meshChatMessages');
            const msgEl = document.createElement('div');
            msgEl.className = 'mesh-message';
            
            let color = '#00ff41';
            let icon = 'üë§';
            if (type === 'system') {
                color = '#0099ff';
                icon = '‚öôÔ∏è';
            } else if (type === 'rudywolf') {
                color = '#ffaa00';
                icon = 'üê∫';
            }
            
            msgEl.innerHTML = `
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                    <span style="color: ${color}; font-weight: bold;">${icon} ${from}</span>
                    <span style="color: #666; font-size: 9px;">${timestamp}</span>
                </div>
                <div style="color: #00ff41;">${text}</div>
            `;
            chatDiv.appendChild(msgEl);
            chatDiv.scrollTop = chatDiv.scrollHeight;
            
            // Add to rudywolf tab if from rudywolf
            if (from === 'rudywolf' || type === 'rudywolf') {
                const rudyDiv = document.getElementById('meshRudywolfMessages');
                const rudyMsgEl = msgEl.cloneNode(true);
                rudyDiv.appendChild(rudyMsgEl);
                rudyDiv.scrollTop = rudyDiv.scrollHeight;
                
                document.getElementById('rudywolfNodeStatus').textContent = 'Online';
                document.getElementById('rudywolfNodeStatus').style.color = '#00ff41';
                document.getElementById('rudywolfLastSeen').textContent = timestamp;
            }
        }
        
        function meshSendMessage() {
            if (!meshConnected) {
                alert('Not connected to mesh network!');
                return;
            }
            
            const input = document.getElementById('meshChatInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            meshAddMessage(currentUser, text, 'chat');
            input.value = '';
            playSound('save');
        }
        
        function meshUpdateNodes() {
            const container = document.getElementById('meshNodesList');
            container.innerHTML = '';
            
            meshNodes.forEach(node => {
                const card = document.createElement('div');
                card.className = 'mesh-node-card';
                
                const age = Date.now() - node.lastSeen;
                const ageText = age < 60000 ? 'Just now' : 
                               age < 3600000 ? Math.floor(age/60000) + 'm ago' :
                               Math.floor(age/3600000) + 'h ago';
                
                const snrColor = node.snr > 7 ? '#00ff00' : node.snr > 4 ? '#ffaa00' : '#ff0000';
                const battColor = node.battery > 80 ? '#00ff00' : node.battery > 40 ? '#ffaa00' : '#ff0000';
                
                card.innerHTML = `
                    <div style="color: #00ff41; font-weight: bold; margin-bottom: 8px; display: flex; align-items: center; gap: 4px;">
                        ${node.id === '!rudywolf' ? 'üê∫' : 'üì°'} ${node.name}
                    </div>
                    <div style="font-size: 10px; color: #00ff41; opacity: 0.8;">
                        <div style="margin-bottom: 2px;"><strong>ID:</strong> ${node.id}</div>
                        <div style="margin-bottom: 2px;"><strong>SNR:</strong> <span style="color: ${snrColor}">${node.snr.toFixed(1)} dB</span></div>
                        <div style="margin-bottom: 2px;"><strong>Battery:</strong> <span style="color: ${battColor}">${node.battery}%</span></div>
                        <div style="margin-bottom: 2px;"><strong>Last:</strong> ${ageText}</div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function meshUpdateMap() {
            const canvas = document.getElementById('meshMapCanvas');
            if (!canvas) return;
            
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;
            
            // Background
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, w, h);
            
            // Grid
            ctx.strokeStyle = 'rgba(0, 255, 65, 0.1)';
            ctx.lineWidth = 1;
            for (let x = 0; x < w; x += 40) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, h);
                ctx.stroke();
            }
            for (let y = 0; y < h; y += 40) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(w, y);
                ctx.stroke();
            }
            
            if (!meshConnected || meshNodes.length === 0) {
                ctx.fillStyle = '#00ff41';
                ctx.font = '14px Courier New';
                ctx.textAlign = 'center';
                ctx.fillText('No nodes to display', w/2, h/2);
                return;
            }
            
            // Calculate bounds
            const lats = meshNodes.map(n => n.lat);
            const lons = meshNodes.map(n => n.lon);
            const minLat = Math.min(...lats);
            const maxLat = Math.max(...lats);
            const minLon = Math.min(...lons);
            const maxLon = Math.max(...lons);
            
            const latRange = maxLat - minLat || 0.01;
            const lonRange = maxLon - minLon || 0.01;
            
            // Draw connections
            ctx.strokeStyle = 'rgba(0, 255, 65, 0.3)';
            ctx.lineWidth = 1;
            for (let i = 0; i < meshNodes.length; i++) {
                for (let j = i + 1; j < meshNodes.length; j++) {
                    const n1 = meshNodes[i];
                    const n2 = meshNodes[j];
                    
                    const x1 = ((n1.lon - minLon) / lonRange) * (w - 60) + 30;
                    const y1 = h - ((n1.lat - minLat) / latRange) * (h - 60) - 30;
                    const x2 = ((n2.lon - minLon) / lonRange) * (w - 60) + 30;
                    const y2 = h - ((n2.lat - minLat) / latRange) * (h - 60) - 30;
                    
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.stroke();
                }
            }
            
            // Draw nodes
            meshNodes.forEach(node => {
                const x = ((node.lon - minLon) / lonRange) * (w - 60) + 30;
                const y = h - ((node.lat - minLat) / latRange) * (h - 60) - 30;
                
                // Outer ring
                ctx.strokeStyle = '#00ff41';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(x, y, 12, 0, Math.PI * 2);
                ctx.stroke();
                
                // Inner circle
                ctx.fillStyle = node.id === '!rudywolf' ? '#ffaa00' : '#004d00';
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, Math.PI * 2);
                ctx.fill();
                
                // Label
                ctx.fillStyle = '#00ff41';
                ctx.font = '10px Courier New';
                ctx.textAlign = 'center';
                ctx.fillText(node.name, x, y + 25);
                
                // Wolf icon for rudywolf
                if (node.id === '!rudywolf') {
                    ctx.font = '12px Arial';
                    ctx.fillText('üê∫', x, y + 4);
                }
            });
        }
        
        function meshSimulateActivity() {
            if (!meshConnected) return;
            
            const activities = [
                {from: 'wolfpack1', text: 'Sector Alpha clear, continuing patrol'},
                {from: 'forestguard', text: 'Network conditions optimal'},
                {from: 'cyberden', text: 'Data sync complete'},
                {from: 'moonhowl', text: 'Position update: moved 50m north'},
                {from: 'rudywolf', text: 'Forest OS monitoring active - all systems green', type: 'rudywolf'},
                {from: 'rudywolf', text: 'Beacon: rudywolf.ru online', type: 'rudywolf'}
            ];
            
            const activity = activities[Math.floor(Math.random() * activities.length)];
            meshAddMessage(activity.from, activity.text, activity.type || 'chat');
            
            // Update node stats
            meshNodes.forEach(node => {
                node.snr += (Math.random() - 0.5) * 0.5;
                node.snr = Math.max(0, Math.min(15, node.snr));
                node.battery = Math.max(0, node.battery - Math.random() * 0.1);
                node.lastSeen = Date.now() - Math.random() * 60000;
            });
            
            meshUpdateNodes();
        }
        
        document.getElementById('meshChatInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                meshSendMessage();
            }
        });
        
        // Init
        currentUser = getUsername();
        
        if (!currentUser) {
            // Show login
            document.getElementById('desktop').style.display = 'none';
        } else {
            // Skip to boot
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('desktop').style.display = 'none';
            startBoot();
            loadWolfConversation();
        }

        // Init player & system
        initPlayer();
        fetchUserInfo();
        loadBackground();
        
        // Override openWindow to init apps
        const originalOpen = openWindow;
        openWindow = function(windowId) {
            originalOpen(windowId);
            
            if (windowId === 'terminalWindow') {
                const output = document.getElementById('terminalOutput');
                if (output.children.length === 0) {
                    terminalPrint('üê∫ Forest OS 98 - WolfSH Terminal');
                    terminalPrint('Type "help" for available commands');
                    terminalPrint('');
                }
                document.getElementById('terminalInput').focus();
            }
            
            if (windowId === 'sysmonWindow' && !sysmonInterval) {
                updateSystemMonitor();
                sysmonInterval = setInterval(updateSystemMonitor, 2000);
            }
            
            if (windowId === 'filesWindow') {
                fileManagerRefresh();
            }
        };

        // Load chat history when Wolf GPT opens
        const originalOpenWindow = openWindow;
        openWindow = function(windowId) {
            originalOpenWindow(windowId);
            
            if (windowId === 'wolfgptWindow') {
                loadWolfConversation();
                const messagesDiv = document.getElementById('wolfgptMessages');
                messagesDiv.innerHTML = '';
                
                if (wolfConversation.length === 0) {
                    addWolfMessage(`*–Ω–∏–∑–∫–∏–π –≤–æ–π —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª* Nocturne –Ω–∞ —Å–≤—è–∑–∏. –ü—Ä–∏–Ω–∞–¥–ª–µ–∂—É RudyWolf (rudywolf.ru). Forest OS 98 –≥–æ—Ç–æ–≤–∞. –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, ${currentUser}.`, 'system');
                } else {
                    wolfConversation.forEach(msg => {
                        addWolfMessage(msg.content, msg.role);
                    });
                }
            }
        };
    </script>
</body>
</html>

